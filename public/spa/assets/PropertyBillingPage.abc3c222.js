import{M as vt,a as bt,P as pl,Q as Ot,b as ml,c as Et,d as fl}from"./PropertyType.model.3dee5368.js";import{bK as xe,c as N,h as j,bL as at,g as nt,r as h,w as de,aI as pe,c1 as Lt,c0 as kt,ca as vl,bo as bl,bX as yl,d as F,i as _e,cn as Wt,C as Ce,o as ce,aQ as A,ae as G,f as l,bj as r,F as le,al as ne,O as P,bH as re,af as u,bS as k,co as Me,cs as Pt,cm as gl,X as Ge,W as fe,U as Rt,bl as Re,ac as Q,cd as hl,ct as Qt,bP as Ht,aS as _l,aW as Ve,aF as wl,cu as Sl,c4 as Pl,aX as Il,bG as It,ad as ue,bF as Ke,bf as Cl,aH as Tl}from"./index.5f74dede.js";import{V as Vl,g as Al,a as $l,b as Dl,c as xl,B as Ne,I as W,d as Be,E as U,Q as Fe,e as Y,u as Nl,f as Bl}from"./index.78f34a68.js";import{Q as te}from"./QBadge.e39c7e1a.js";import{u as Yt,_ as Oe,l as je,a as se,m as mt,y as Ol,L as Ue,b as tt,Q as Ze,c as El}from"./DialogCard.3469606c.js";import{Q as z}from"./QCardSection.8ec3183b.js";import{Q as ft}from"./QCard.fd4889e8.js";import{u as be,P as ae,Q as ie,I as Ll,a as Xe}from"./PropertySubscription.handler.9730b093.js";import{Q as kl}from"./QPage.7a078e42.js";import{g as Rl}from"./get-css-var.23548d6a.js";import{u as ql,a as Ul,v as qt,b as Ml,d as Gl,e as Fl,f as jl,h as Wl,i as Ql,r as Ut,s as Hl,p as Mt,j as Yl,Q as zl}from"./QMenu.294f6449.js";import{u as zt,b as Kt,d as Kl,e as Zt,c as Gt,Q as $e,a as De}from"./use-timeout.7e016b9f.js";import{Q as At,u as Zl,a as Xl,b as Jl}from"./QCheckbox.1d3f000e.js";import{c as Z,i as Ee}from"./utils.01331f21.js";import{api as Xt}from"./axios.06e6e18e.js";import{U as he}from"./urlPaths.enum.4e223ac0.js";import{r as Ae}from"./default.request.67052eb8.js";import{u as ea}from"./billing-store.704ab9c9.js";import{I as ta}from"./IsEmail.362df045.js";import{C as la}from"./ClosePopup.4f7d0009.js";import"./QResizeObserver.e808dfbc.js";import"./use-dark.8b3d0d40.js";import"./touch.3df10340.js";import"./focus-manager.02955f48.js";import"./QSeparator.80b8ef03.js";import"./QList.87f99778.js";import"./storeforage.21ccbd50.js";import"./format.11c13342.js";var Je=xe({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(e,{slots:t}){const o=nt(),n=N(()=>"q-td"+(e.autoWidth===!0?" q-table--col-auto-width":"")+(e.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(e.props===void 0)return j("td",{class:n.value},at(t.default));const a=o.vnode.key,s=(e.props.colsMap!==void 0?e.props.colsMap[a]:null)||e.props.col;if(s===void 0)return;const{row:i}=e.props;return j("td",{class:n.value+s.__tdClass(i),style:s.__tdStyle(i)},at(t.default))}}}),qe=xe({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:t}){const o=N(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>j("tr",{class:o.value},at(t.default))}}),$t=xe({name:"QTooltip",inheritAttrs:!1,props:{...ql,...zt,...Ul,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:qt},self:{type:String,default:"top middle",validator:qt},offset:{type:Array,default:()=>[14,14],validator:Ml},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0}},emits:[...Kt],setup(e,{slots:t,emit:o,attrs:n}){let a,s;const i=nt(),{proxy:{$q:m}}=i,d=h(null),c=h(!1),C=N(()=>Mt(e.anchor,m.lang.rtl)),T=N(()=>Mt(e.self,m.lang.rtl)),O=N(()=>e.persistent!==!0),{registerTick:b,removeTick:M}=Gl(),{registerTimeout:_}=Kl(),{transitionProps:v,transitionStyle:$}=Fl(e),{localScrollTarget:L,changeScrollEvent:X,unconfigureScrollTarget:R}=jl(e,it),{anchorEl:V,canShow:p,anchorEvents:D}=Wl({showing:c,configureAnchorEl:ve}),{show:H,hide:me}=Zt({showing:c,canShow:p,handleShow:S,handleHide:I,hideOnRouteChange:O,processOnMount:!0});Object.assign(D,{delayShow:Se,delayHide:J});const{showPortal:B,hidePortal:x,renderPortal:q}=Ql(i,d,wt,"tooltip");if(m.platform.is.mobile===!0){const ee={anchorEl:V,innerRef:d,onClickOutside(ge){return me(ge),ge.target.classList.contains("q-dialog__backdrop")&&yl(ge),!0}},We=N(()=>e.modelValue===null&&e.persistent!==!0&&c.value===!0);de(We,ge=>{(ge===!0?Yl:Ut)(ee)}),pe(()=>{Ut(ee)})}function S(ee){B(),b(()=>{s=new MutationObserver(()=>E()),s.observe(d.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),E(),it()}),a===void 0&&(a=de(()=>m.screen.width+"|"+m.screen.height+"|"+e.self+"|"+e.anchor+"|"+m.lang.rtl,E)),_(()=>{B(!0),o("show",ee)},e.transitionDuration)}function I(ee){M(),x(),y(),_(()=>{x(!0),o("hide",ee)},e.transitionDuration)}function y(){s!==void 0&&(s.disconnect(),s=void 0),a!==void 0&&(a(),a=void 0),R(),Lt(D,"tooltipTemp")}function E(){Hl({targetEl:d.value,offset:e.offset,anchorEl:V.value,anchorOrigin:C.value,selfOrigin:T.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function Se(ee){if(m.platform.is.mobile===!0){Gt(),document.body.classList.add("non-selectable");const We=V.value,ge=["touchmove","touchcancel","touchend","click"].map(ut=>[We,ut,"delayHide","passiveCapture"]);kt(D,"tooltipTemp",ge)}_(()=>{H(ee)},e.delay)}function J(ee){m.platform.is.mobile===!0&&(Lt(D,"tooltipTemp"),Gt(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),_(()=>{me(ee)},e.hideDelay)}function ve(){if(e.noParentEvent===!0||V.value===null)return;const ee=m.platform.is.mobile===!0?[[V.value,"touchstart","delayShow","passive"]]:[[V.value,"mouseenter","delayShow","passive"],[V.value,"mouseleave","delayHide","passive"]];kt(D,"anchor",ee)}function it(){if(V.value!==null||e.scrollTarget!==void 0){L.value=vl(V.value,e.scrollTarget);const ee=e.noParentEvent===!0?E:me;X(L.value,ee)}}function _t(){return c.value===!0?j("div",{...n,ref:d,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",n.class],style:[n.style,$.value],role:"tooltip"},at(t.default)):null}function wt(){return j(bl,v.value,_t)}return pe(y),Object.assign(i.proxy,{updatePosition:E}),q}});function ot(e){return function(t,o){var n={type:Vl.CONDITIONAL_VALIDATION,target:t.constructor,propertyName:o,constraints:[function(a,s){return a[o]!==null&&a[o]!==void 0}],validationOptions:e};Al().addValidationMetadata(new $l(n))}}var aa="isBoolean";function na(e){return e instanceof Boolean||typeof e=="boolean"}function oa(e){return Dl({name:aa,validator:{validate:function(t,o){return na(t)},defaultMessage:xl(function(t){return t+"$property must be a boolean value"},e)}},e)}var ra=Object.defineProperty,sa=Object.getOwnPropertyDescriptor,we=(e,t,o,n)=>{for(var a=n>1?void 0:n?sa(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&ra(t,o,a),a};class ye extends Ne{id;propertyName;propertyUnit;expectedMonthlyCost;propertyTypeId;streetId;streetNumber;oldCode;propertySubscriberProfileId;isOwner=!1}we([W({message:"Please, enter the property name"})],ye.prototype,"propertyName",2);we([W({message:"Please, enter the property unit"})],ye.prototype,"propertyUnit",2);we([ot()],ye.prototype,"expectedMonthlyCost",2);we([W({message:"Please, select the property type"})],ye.prototype,"propertyTypeId",2);we([W({message:"Please, select the street"})],ye.prototype,"streetId",2);we([W({message:"Please, enter the street number"})],ye.prototype,"streetNumber",2);we([ot()],ye.prototype,"oldCode",2);we([W({message:"Please, select a custiodian"})],ye.prototype,"propertySubscriberProfileId",2);we([oa()],ye.prototype,"isOwner",2);const ia={class:"row justify-between"},ua={class:"q-gutter-xl"},da={class:"q-gutter-xl"},ca={style:{width:"20rem"}},pa={class:"row justify-center q-mt-xl",style:{width:"100%"}},ma=F({__name:"NewPropertySubscription",emits:["addSubscriber","addPropertyType","addStreet"],setup(e,{emit:t}){F({name:"new-property-subscription"});const o=t,n=_e("eventBus"),a={width:"35rem"},s={width:"30rem"},i=be();ae.handlePostSubscription(n,{onSuccess:L,onError:X});const m=Yt();let d;const c=h(),C=h([]),T=h([]),{streets:O}=Wt(m),b=Ce(new ye),M=N(()=>C.value.map(V=>({label:V.firstName+" "+V.lastName,value:V.id}))),_=N(()=>T.value.map(V=>({label:`${V.name} - ${V.unitPrice}`,value:V.id}))),v=N(()=>{var V;return(V=O==null?void 0:O.value)==null?void 0:V.map(p=>({label:p.name,value:p.id}))});Be(async()=>{b.validate()});async function $(){var V;if(b.validate(),!Ee(b)){console.log("the following errors exist",b.errors),await((V=c.value)==null?void 0:V.validate());return}i.loading.show({message:"Submitting ..."}),n.emit(U.NEW_PROPERTY_SUBSCRIPTION,b),d=setTimeout(()=>{i.loading.hide()},je)}function L(){b.clearValues(),Z({loader:i.loading,timer:d})}function X(){Z({loader:i.loading,timer:d})}function R(V){o(V)}return de([()=>b.propertyTypeId,()=>b.propertyUnit],([V,p])=>{if(V&&p){const D=T.value.find(H=>H.id===V);return b.expectedMonthlyCost=String(Number(D==null?void 0:D.unitPrice)*p),b.expectedMonthlyCost}}),ce(async()=>{try{O!=null&&O.value||m.fetchServerData({type:"street"}),T.value=await ae.getPropertyTypes(),C.value=await ae.getSubscriberUsers()}catch(V){console.log(V)}}),pe(()=>{n.off(U.NEW_PROPERTY_SUBSCRIPTION)}),(V,p)=>(A(),G(le,null,[l(z,{class:"text-center"},{default:r(()=>[l(Oe,null,{default:r(()=>[ne("New Property Subscription")]),_:1})]),_:1}),l(z,null,{default:r(()=>[l(P(Fe),{class:"q-pa-md",style:{height:"100%"},onSubmit:p[15]||(p[15]=re(()=>{},["prevent"])),ref_key:"propertySubscriptionForm",ref:c},{default:r(()=>[u("div",ia,[u("div",ua,[l(Y,{style:s,label:"Property Name",type:"text",modelValue:b.propertyName,"onUpdate:modelValue":p[0]||(p[0]=D=>b.propertyName=D),filled:"",outlined:"",color:"secondary","label-color":"dark",rules:[()=>V.$validateField(b,"propertyName")]},null,8,["modelValue","rules"]),l(Y,{style:s,label:"Property Unit",type:"text",modelValue:b.propertyUnit,"onUpdate:modelValue":p[1]||(p[1]=D=>b.propertyUnit=D),filled:"",outlined:"",color:"secondary","label-color":"dark",rules:[()=>V.$validateField(b,"propertyUnit")]},null,8,["modelValue","rules"]),l(Y,{style:s,label:"Expected Monthly Cost",type:"text",modelValue:b.expectedMonthlyCost,"onUpdate:modelValue":p[2]||(p[2]=D=>b.expectedMonthlyCost=D),filled:"",outlined:"",color:"secondary","label-color":"dark"},{default:r(()=>[l($t,null,{default:r(()=>[ne("Expected Monthly Cost")]),_:1})]),_:1},8,["modelValue"]),l(Y,{style:s,label:"Old Code",type:"text",modelValue:b.oldCode,"onUpdate:modelValue":p[3]||(p[3]=D=>b.oldCode=D),filled:"",outlined:"",color:"secondary","label-color":"dark"},null,8,["modelValue"])]),u("div",da,[u("div",{class:"row",style:a},[l(P(ie),{style:{width:"70%"},label:"Street",filled:"",outlined:"",modelValue:b.streetId,"onUpdate:modelValue":p[6]||(p[6]=D=>b.streetId=D),color:"secondary","label-color":"dark",options:v.value,rules:[()=>V.$validateField(b,"streetId")],clearable:"","emit-value":"","map-options":""},{append:r(()=>[l(P(k),{round:"",flat:"",dense:"",icon:"add",onClick:p[4]||(p[4]=re(D=>R("addStreet"),["prevent","stop"]))})]),"no-option":r(()=>[l($e,null,{default:r(()=>[l(De,{class:"text-grey"},{default:r(()=>[l(P(k),{flat:"",dense:"",label:"Add Street",onClick:p[5]||(p[5]=D=>R("addStreet"))})]),_:1})]),_:1})]),_:1},8,["modelValue","options","rules"]),l(Y,{style:{width:"30%"},label:"Number",type:"text",modelValue:b.streetNumber,"onUpdate:modelValue":p[7]||(p[7]=D=>b.streetNumber=D),filled:"",outlined:"",color:"secondary","label-color":"dark"},{default:r(()=>[l($t,null,{default:r(()=>[ne("Street Number")]),_:1})]),_:1},8,["modelValue"])]),u("div",{style:a},[l(P(ie),{style:{width:"100%"},label:"Property Type",filled:"",outlined:"",modelValue:b.propertyTypeId,"onUpdate:modelValue":p[10]||(p[10]=D=>b.propertyTypeId=D),color:"secondary","label-color":"dark",options:_.value,clearable:"",rules:[()=>V.$validateField(b,"propertyTypeId")],"emit-value":"","map-options":""},{append:r(()=>[l(P(k),{round:"",dense:"",flat:"",icon:"add",onClick:p[8]||(p[8]=re(D=>R("addPropertyType"),["prevent","stop"]))})]),"no-option":r(()=>[l($e,null,{default:r(()=>[l(De,{class:"text-grey"},{default:r(()=>[l(P(k),{dense:"",flat:"",label:"Add Property Type",onClick:p[9]||(p[9]=D=>R("addPropertyType"))})]),_:1})]),_:1})]),_:1},8,["modelValue","options","rules"])]),u("div",{style:a},[l(P(ie),{style:{width:"100%"},label:"Custodian",filled:"",outlined:"",modelValue:b.propertySubscriberProfileId,"onUpdate:modelValue":p[13]||(p[13]=D=>b.propertySubscriberProfileId=D),color:"secondary","label-color":"dark",clearable:"",options:M.value,rules:[()=>V.$validateField(b,"propertySubscriberProfileId")],"emit-value":"","map-options":""},{append:r(()=>[l(P(k),{round:"",dense:"",flat:"",icon:"add",onClick:p[11]||(p[11]=re(D=>R("addSubscriber"),["prevent","stop"]))})]),"no-option":r(()=>[l($e,null,{default:r(()=>[l(De,{class:"text-grey"},{default:r(()=>[l(P(k),{dense:"",flat:"",label:"Add Subscriber",onClick:p[12]||(p[12]=D=>R("addSubscriber"))})]),_:1})]),_:1})]),_:1},8,["modelValue","options","rules"])]),u("div",ca,[l(At,{label:"Is Owner",modelValue:b.isOwner,"onUpdate:modelValue":p[14]||(p[14]=D=>b.isOwner=D),color:"primary"},null,8,["modelValue"])])])]),u("div",pa,[l(P(k),{style:{width:"40%"},label:"Submit",rounded:"",color:"primary",type:"submit",onClick:re($,["prevent"])})])]),_:1},512)]),_:1})],64))}});var fa=xe({name:"QToggle",props:{...Zl,icon:String,iconColor:String},emits:Xl,setup(e){function t(o,n){const a=N(()=>(o.value===!0?e.checkedIcon:n.value===!0?e.indeterminateIcon:e.uncheckedIcon)||e.icon),s=N(()=>o.value===!0?e.iconColor:null);return()=>[j("div",{class:"q-toggle__track"}),j("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},a.value!==void 0?[j(Me,{name:a.value,color:s.value})]:void 0)]}return Jl("toggle",t)}}),va=Object.defineProperty,ba=Object.getOwnPropertyDescriptor,yt=(e,t,o,n)=>{for(var a=n>1?void 0:n?ba(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&va(t,o,a),a};class rt extends Ne{streetId;propertySuscriptionId;month;year;type;forAllProperties;forPropertiesOnStreet}yt([ot()],rt.prototype,"streetId",2);yt([W({message:"Please, select the property subscsription"})],rt.prototype,"propertySuscriptionId",2);yt([W({message:"Please, select the month"})],rt.prototype,"month",2);yt([W({message:"Please, select the year"})],rt.prototype,"year",2);async function ya(e){const t=await Xt.post(he.BILLING,e);if(t.status===201)return t.data;throw new Error("Attempt to generate billing failed",{cause:t.data})}async function ga(e){const t=await Xt.get(he.BILLING,{params:e});if(t.status===200)return t.data;throw new Error("Could not fetch billings")}class Dt{static async handGenerateBilling(t,{onSuccess:o,onError:n}={}){t.on(U.GENERATE_BILLING,async a=>{try{await ya(a),o==null||o(),Pt.create({message:"Process was successful",color:"positive"})}catch(s){n==null||n(),Pt.create({message:s.message,color:"negative",icon:"warning",timeout:5e3})}})}static async getBilling(t){try{return await ga(t)}catch(o){Pt.create({message:o.message,color:"negative",icon:"warning",timeout:5e3})}}static async deleteBilling(t){return await Ae(he.BILLING,"delete",{params:{billingId:t}})}static async updateArrears(t){await Ae(he.UPDATE_ARREARS,"put",{body:t})}}class et{static async getBillingAccountArrears(t){try{const o=t.limit,n=t.page;return await Ae(he.BILLING_ACCOUNT_ARREARS,"get",{params:{limit:o,page:n,month:t.month}})}catch{se({type:"negative"})}}static async handleViewBillingDetails(t,{onSuccess:o,onError:n}={}){t.on(U.VIEW_BILLING_DETAILS,async({streetId:a,billingMonth:s})=>{try{const i=await Ae(he.BILLING_ACCOUNT_DETAILS.replace(":streetId",a),"get",{params:{billingMonth:s}});o==null||o(i)}catch(i){n==null||n(i),se({type:"negative"})}})}static async handleGetDefaulters(t,{onSuccess:o,onError:n}={}){t.on(U.GET_DEFAULTERS,async({streetId:a})=>{try{const s=await Ae(he.BILLING_ACCOUNT_DEFAULTER.replace(":streetId",a),"get");o==null||o(s)}catch(s){n==null||n(s),se({type:"negative"})}})}static async getBillingsForPrinting(t,o,n){const a=await Ae(he.BILLING_ACCOUNT_DETAILS.replace(":streetId",t),"get",{params:{billingMonth:o,propertySubscriptionId:n}});return ea().updateBilling({type:"billingDetail",data:a}),a}}const ha={class:"row justify-between q-my-lg"},_a={class:"q-gutter-xl",style:{width:"40%"}},wa={class:"q-gutter-xl",style:{width:"50%"}},Sa={class:"row justify-between q-mt-md",style:{height:"7rem"}},Pa={class:"column"},Ia={class:"column justify-end",style:{height:"100%"}},Ca=F({__name:"GenerateBill",setup(e){F({name:"generate-bill"});const t=Yt(),o=mt[new Date().getMonth()+1],n=_e("eventBus"),a=be(),s=gl();let i;Dt.handGenerateBilling(n,{onSuccess:H,onError:me});const m=h("generate"),{streets:d}=Wt(t),c=h(),C=h();h("");const T=N(()=>{var B;return(B=d==null?void 0:d.value)==null?void 0:B.map(x=>({label:x.name,value:x.id}))}),O=h(T.value);function b(B,x){if(B===""){x(()=>{O.value=T.value});return}x(()=>{var S;const q=B.toLowerCase();O.value=(S=T.value)==null?void 0:S.filter(I=>I.label.toLowerCase().indexOf(q)>-1)})}const M=N(()=>m.value==="print"?"Print Bill":"Generate Bill"),_=N(()=>Ol),v=N(()=>Object.values(mt).map(B=>B)),$=N(()=>m.value==="print"?"Print":"Generate"),L=N(()=>{var B;return(B=c.value)==null?void 0:B.map(x=>({label:x.propertySubscriptionName,value:x.propertySubscriptionId}))}),X=h(L.value);function R(B,x){if(B===""){x(()=>{X.value=L.value});return}x(()=>{var S;const q=B.toLowerCase();X.value=(S=L.value)==null?void 0:S.filter(I=>I.label.toLowerCase().indexOf(q)>-1)})}const V=N(()=>p.month+" "+p.year),p=Ce(new rt);async function D(){if(a.loading.show({message:"Please, wait ..."}),p.type==="print"){await et.getBillingsForPrinting(p.streetId,p.month,p.propertySuscriptionId),s.push(`/print/${V.value}`);return}else n.emit(U.GENERATE_BILLING,p);i=setTimeout(()=>{a.loading.show()},je)}function H(){p.clearValues(),Z({loader:a.loading,timer:i})}function me(){Z({loader:a.loading,timer:i})}return de(m,B=>{B&&(p.type=B)}),de(()=>p.forAllProperties,B=>{B&&(p.forPropertiesOnStreet=!1)}),de(()=>p.streetId,async B=>{if(console.log("this is the new val from watch on streetId",B),B){p.propertySuscriptionId="";const x=await ae.getSubscriptions({streetId:B});c.value=x==null?void 0:x.data}}),ce(()=>{p.month=o,p.year=String(new Date().getFullYear()),p.type=m.value}),ce(async()=>{d!=null&&d.value||await t.fetchServerData({type:"street"})}),ce(async()=>{const B=await ae.getSubscriptions();c.value=B==null?void 0:B.data}),pe(()=>{Z({loader:a.loading,timer:i})}),(B,x)=>(A(),G(le,null,[l(z,{class:"row justify-between"},{default:r(()=>[u("div",{style:fe({color:`${B.$getColor("primary")}`})},[l(Oe,{"header-text-size":"h5"},{default:r(()=>[ne(Ge(M.value),1)]),_:1})],4),u("div",null,[u("span",{class:Rt([m.value==="print"?"text-primary":""])},"Print Bill",2),l(fa,{"toggle-indeterminate":!1,"toggle-order":"tf","true-value":"generate","false-value":"print",modelValue:m.value,"onUpdate:modelValue":x[0]||(x[0]=q=>m.value=q),"keep-color":""},null,8,["modelValue"]),u("span",{class:Rt([m.value!=="print"?"text-primary":""])},"Generate Bill",2)])]),_:1}),l(z,null,{default:r(()=>[u("form",{class:"q-pa-md",style:{height:"100%"},onSubmit:x[7]||(x[7]=re(()=>{},["prevent"])),ref_key:"billingModelForm",ref:C},[u("div",ha,[u("div",_a,[l(ie,{label:"Street",modelValue:p.streetId,"onUpdate:modelValue":x[1]||(x[1]=q=>p.streetId=q),filled:"",outlined:"",color:"secondary","label-color":"dark",options:O.value,"emit-value":"","map-options":"","use-input":"",onFilter:b,clearable:""},null,8,["modelValue","options"]),l(ie,{modelValue:p.month,"onUpdate:modelValue":x[2]||(x[2]=q=>p.month=q),label:"Month",type:"text",filled:"",outlined:"",color:"secondary","label-color":"dark",options:v.value},null,8,["modelValue","options"])]),u("div",wa,[l(ie,{modelValue:p.propertySuscriptionId,"onUpdate:modelValue":x[3]||(x[3]=q=>p.propertySuscriptionId=q),label:"Property Subscription Id",type:"text",filled:"",outlined:"",color:"secondary","label-color":"dark",options:X.value,"emit-value":"","map-options":"","use-input":"",onFilter:R,clearable:""},null,8,["modelValue","options"]),l(ie,{modelValue:p.year,"onUpdate:modelValue":x[4]||(x[4]=q=>p.year=q),label:"Year",type:"text",filled:"",outlined:"",options:_.value,color:"secondary","label-color":"dark","emit-value":"","map-options":""},null,8,["modelValue","options"])])]),u("div",Sa,[u("div",Pa,[l(At,{label:`${$.value} for properties on street.`,modelValue:p.forPropertiesOnStreet,"onUpdate:modelValue":x[5]||(x[5]=q=>p.forPropertiesOnStreet=q),disable:p.forAllProperties},null,8,["label","modelValue","disable"]),l(At,{label:`${$.value} all bills.`,modelValue:p.forAllProperties,"onUpdate:modelValue":x[6]||(x[6]=q=>p.forAllProperties=q)},null,8,["label","modelValue"])]),u("div",Ia,[l(k,{rounded:"",color:"primary",onClick:D},{default:r(()=>[ne(Ge(m.value==="print"?"Print":"Generate"),1)]),_:1})])])],544)]),_:1})],64))}});var Ta=Object.defineProperty,Va=Object.getOwnPropertyDescriptor,Le=(e,t,o,n)=>{for(var a=n>1?void 0:n?Va(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&Ta(t,o,a),a};class Te extends Ne{id;firstName;lastName;email;oldCode;phone;phoneCodeId;password}Le([W({message:"First name is required"}),vt(2,{message:"First name must be at least 2 characters"}),bt(50,{message:"First name must be less than 50 characters"})],Te.prototype,"firstName",2);Le([W({message:"Last name is required"})],Te.prototype,"lastName",2);Le([W({message:"Email is required"}),ta({},{message:"Email is invalid"})],Te.prototype,"email",2);Le([ot()],Te.prototype,"oldCode",2);Le([W({message:"Phone number is required"})],Te.prototype,"phone",2);Le([W({message:"Phone code is required"})],Te.prototype,"phoneCodeId",2);Le([ot()],Te.prototype,"password",2);const st=F({__name:"ModalPopupClose",setup(e){return F({name:"modal-popup-close"}),(t,o)=>Re((A(),Q(k,{round:"",dense:"",icon:"close"},null,512)),[[la]])}}),Aa={class:"row justify-between q-py-sm"},$a={class:"row justify-between"},Da={class:"q-gutter-xl"},xa={class:"q-gutter-xl"},Na={class:"flex row"},Ba={class:"flex row justify-center"},Oa=F({__name:"AddSubscriber",setup(e){var b,M;F({name:"add-subscriber"});const t=_e("eventBus"),o=be(),n=h(),a=h();(b=n.value)==null||b.focus(),(M=a.value)==null||M.focus();const s=h([]),i=h();ae.handlePostSubscriberUser(t,{onSuccess:T,onError:O});let m;const d=Ce(new Te);Be(async()=>{await d.validate()});const c=N(()=>{var _;return(_=s.value)==null?void 0:_.map(v=>({label:v.name,value:v.id}))});function C(){var _;if(!Ee(d)){(_=i.value)==null||_.validate();return}t.emit(U.POST_SUBSCRIBER,d),o.loading.show({message:"Submitting ..."}),m=setTimeout(()=>{o.loading.hide()},je)}function T(){d.clearValues(),Z({loader:o.loading,timer:m})}function O(){Z({loader:o.loading,timer:m})}return ce(async()=>{var _,v;console.log((_=a.value)==null?void 0:_.focus),(v=n.value)==null||v.focus(),s.value=await ae.getPhoneCodes()}),pe(()=>{Z({loader:o.loading,timer:m}),t.off(U.POST_SUBSCRIBER)}),(_,v)=>(A(),G(le,null,[l(z,{class:"q-px-md"},{default:r(()=>[u("div",Aa,[l(Oe,null,{default:r(()=>[ne(" Add Subscriber ")]),_:1}),u("div",null,[l(st)])])]),_:1}),l(z,{class:"q-px-md"},{default:r(()=>[l(P(Fe),{onSubmit:v[6]||(v[6]=re(()=>{},["prevent"])),ref_key:"subscriberForm",ref:i},{default:r(()=>[u("div",$a,[u("div",Da,[l(P(Y),{label:"First Name",filled:"",outlined:"",modelValue:d.firstName,"onUpdate:modelValue":v[0]||(v[0]=$=>d.firstName=$),"lazy-rules":"",rules:[()=>_.$validateField(d,"firstName")],ref_key:"inputRef",ref:a},null,8,["modelValue","rules"]),l(P(Y),{label:"Email",filled:"",outlined:"",modelValue:d.email,"onUpdate:modelValue":v[1]||(v[1]=$=>d.email=$),"lazy-rules":"",rules:[()=>_.$validateField(d,"email")]},null,8,["modelValue","rules"]),l(P(Y),{label:"Old Code",filled:"",outlined:"",modelValue:d.oldCode,"onUpdate:modelValue":v[2]||(v[2]=$=>d.oldCode=$),"lazy-rules":"",rules:[()=>_.$validateField(d,"oldCode")]},null,8,["modelValue","rules"])]),u("div",xa,[l(P(Y),{label:"Last Name",filled:"",outlined:"",modelValue:d.lastName,"onUpdate:modelValue":v[3]||(v[3]=$=>d.lastName=$),"lazy-rules":"",rules:[()=>_.$validateField(d,"lastName")]},null,8,["modelValue","rules"]),u("div",Na,[l(ie,{label:"Country Phone Code",filled:"",outlined:"","label-color":"dark",modelValue:d.phoneCodeId,"onUpdate:modelValue":v[4]||(v[4]=$=>d.phoneCodeId=$),options:c.value,"emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options"]),l(P(Y),{label:"Phone",filled:"",outlined:"",modelValue:d.phone,"onUpdate:modelValue":v[5]||(v[5]=$=>d.phone=$),"lazy-rules":"",rules:[()=>_.$validateField(d,"phone")]},null,8,["modelValue","rules"])])])]),u("div",Ba,[l(k,{style:{width:"40%"},label:"Submit",rounded:"",color:"primary",type:"submit",onClick:C})])]),_:1},512)]),_:1})],64))}});var Ea=Object.defineProperty,La=Object.getOwnPropertyDescriptor,xt=(e,t,o,n)=>{for(var a=n>1?void 0:n?La(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&Ea(t,o,a),a};class gt extends Ne{id;name;lgaId;lgaWardId}xt([W({message:"Street name is required"}),vt(2,{message:"Street name cannot be less than 2 characters"}),bt(50,{message:"Street name cannot be more than 255 characters"})],gt.prototype,"name",2);xt([W({message:"Select an Lga"})],gt.prototype,"lgaId",2);xt([W({message:"Select an Lga ward"})],gt.prototype,"lgaWardId",2);const ka={class:"flex row justify-between"},Ra={class:"q-gutter-xl"},qa={class:"flex row justify-center q-mt-lg"},Ua=F({__name:"AddStreet",emits:["addLga","addLgaWard"],setup(e){F({name:"add-street"});const t=h([]),o=h([]),n=_e("eventBus"),a=be(),s=h(),i=h(!1);let m;const d=Ce(new gt);Ue.handlePostStreet(n,{onSuccess:O,onError:b});const c=N(()=>t.value.map(_=>({label:_.name,value:_.id}))),C=N(()=>o.value.map(_=>({label:_.name,value:_.id})));Be(async()=>{await d.validate()});function T(){var _;if(!i.value){if(!Ee(d)){(_=s.value)==null||_.validate();return}i.value=!0,a.loading.show({message:"Submitting ..."}),n.emit(U.POST_STREET,d),m=setTimeout(()=>{a.loading.hide()},je)}}function O(){d.clearValues(),Z({loader:a.loading,timer:m})}function b(){Z({loader:a.loading,timer:m})}function M(_){n.emit(_)}return de(()=>d.lgaId,async _=>{o.value=await Ue.getLgaWards({lgaId:_})}),ce(async()=>{t.value=await Ue.getLgas()}),pe(()=>{Z({loader:a.loading,timer:m})}),pe(()=>{n.off(U.POST_STREET)}),(_,v)=>(A(),G(le,null,[l(z,null,{default:r(()=>[u("div",ka,[l(Oe,null,{default:r(()=>[ne("Add Street")]),_:1}),l(st)])]),_:1}),l(z,null,{default:r(()=>[l(P(Fe),{class:"q-px-lg",onSubmit:v[7]||(v[7]=re(()=>{},["prevent"])),ref_key:"addStreetForm",ref:s},{default:r(()=>[u("div",Ra,[l(Y,{label:"Street Name",type:"text",modelValue:d.name,"onUpdate:modelValue":v[0]||(v[0]=$=>d.name=$),filled:"",outlined:"",color:"secondary","label-color":"dark",rules:[()=>_.$validateField(d,"name")]},null,8,["modelValue","rules"]),l(ie,{label:"Lga",filled:"",outlined:"",color:"secondary","label-color":"dark",options:c.value,rules:[()=>_.$validateField(d,"lgaId")],modelValue:d.lgaId,"onUpdate:modelValue":v[3]||(v[3]=$=>d.lgaId=$),"emit-value":"","map-options":"",clearable:""},{append:r(()=>[l(k,{round:"",flat:"",dense:"",icon:"add",onClick:v[1]||(v[1]=re($=>M(P(U).TRIGGER_REMOTE_MODAL_LGA),["prevent","stop"]))})]),"no-option":r(()=>[l($e,null,{default:r(()=>[l(De,{class:"text-grey"},{default:r(()=>[l(k,{label:"Add LGA",dense:"",flat:"",onClick:v[2]||(v[2]=$=>M(P(U).TRIGGER_REMOTE_MODAL_LGA))})]),_:1})]),_:1})]),_:1},8,["options","rules","modelValue"]),l(ie,{label:"LGA Ward",filled:"",outlined:"",color:"secondary","label-color":"dark",options:C.value,rules:[()=>_.$validateField(d,"lgaWardId")],modelValue:d.lgaWardId,"onUpdate:modelValue":v[6]||(v[6]=$=>d.lgaWardId=$),"emit-value":"","map-options":"",clearable:""},{append:r(()=>[l(k,{round:"",flat:"",dense:"",icon:"add",onClick:v[4]||(v[4]=re($=>M(P(U).TRIGGER_REMOTE_MODAL_LGA_WARD),["prevent","stop"]))})]),"no-option":r(()=>[l($e,null,{default:r(()=>[l(De,{class:"text-grey"},{default:r(()=>[l(k,{label:"Add LGA Ward",flat:"",dense:"",onClick:v[5]||(v[5]=$=>M(P(U).TRIGGER_REMOTE_MODAL_LGA_WARD))})]),_:1})]),_:1})]),_:1},8,["options","rules","modelValue"])]),u("div",qa,[l(k,{style:{width:"40%"},label:"submit",type:"submit",color:"primary",rounded:"",onClick:T})])]),_:1},512)]),_:1})],64))}}),Ma={class:"flex row justify-between"},Ga={class:"q-gutter-md"},Fa={class:"flex row justify-center"},ja=F({__name:"AddPropertyType",setup(e){const t=h(),o=_e("eventBus"),n=be();let a;const s=Ce(new pl);Be(async()=>{await s.validate()});function i(){var c;Ee(s)||(c=t.value)==null||c.validate(),n.loading.show({message:"Submitting ..."}),o.emit(U.POST_PROPERTY_TYPE,s),a=setTimeout(()=>{n.loading.hide()},2e3)}function m(){s.clearValues(),Z({loader:n.loading,timer:a})}function d(){Z({loader:n.loading,timer:a})}return ce(()=>{ae.handlePostPropertyType(o,{onSuccess:m,onError:d})}),pe(()=>{o.off(U.POST_PROPERTY_TYPE)}),(c,C)=>(A(),G(le,null,[l(z,null,{default:r(()=>[u("div",Ma,[l(Oe,null,{default:r(()=>[ne("Add Property Type")]),_:1}),l(st)])]),_:1}),l(z,null,{default:r(()=>[l(P(Fe),{class:"q-px-",onSubmit:C[2]||(C[2]=re(()=>{},["prevent"]))},{default:r(()=>[u("div",Ga,[l(Y,{label:"Name",type:"text",modelValue:s.name,"onUpdate:modelValue":C[0]||(C[0]=T=>s.name=T),filled:"",outlined:"",color:"secondary","label-color":"dark",rules:[()=>c.$validateField(s,"name")]},null,8,["modelValue","rules"]),l(Y,{label:"Unit Price",type:"number",modelValue:s.unitPrice,"onUpdate:modelValue":C[1]||(C[1]=T=>s.unitPrice=T),filled:"",outlined:"",color:"secondary","label-color":"dark",rules:[()=>c.$validateField(s,"unitPrice")]},null,8,["modelValue","rules"])]),u("div",Fa,[l(k,{style:{width:"40%"},label:"submit",type:"submit",color:"primary",rounded:"",onClick:re(i,["prevent"])})])]),_:1})]),_:1})],64))}});var Wa=Object.defineProperty,Qa=Object.getOwnPropertyDescriptor,Ha=(e,t,o,n)=>{for(var a=n>1?void 0:n?Qa(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&Wa(t,o,a),a};class Jt extends Ne{id;name}Ha([W({message:"LGA name is required"}),vt(2,{message:"LGA name must be at least 2 characters"}),bt(50,{message:"LGA name must be less than 50 characters"})],Jt.prototype,"name",2);const Ya={class:"flex row justify-between"},za={class:"flex row justify-center q-mt-lg"},Ka=F({__name:"AddLga",setup(e){F({name:"add-lga"});const t=_e("eventBus"),o=be();let n;const a=Ce(new Jt);Ue.handlePostLga(t,{onSuccess:i,onError:m}),Be(async()=>{await a.validate()});function s(){!Ee(a)||(o.loading.show({message:"Submitting ..."}),t.emit(U.POST_LGA,a),n=setTimeout(()=>{o.loading.hide()},je))}function i(){a.clearValues(),Z({loader:o.loading,timer:n})}function m(){Z({loader:o.loading,timer:n})}return pe(()=>{Z({loader:o.loading,timer:n})}),pe(()=>{t.off(U.POST_LGA)}),(d,c)=>(A(),G(le,null,[l(z,null,{default:r(()=>[u("div",Ya,[l(Oe,null,{default:r(()=>[ne("Add L.G.A.")]),_:1}),l(st)])]),_:1}),l(z,null,{default:r(()=>[u("form",null,[u("div",null,[l(Y,{label:"Name",filled:"",outlined:"","label-color":"dark",modelValue:a.name,"onUpdate:modelValue":c[0]||(c[0]=C=>a.name=C),rules:[()=>d.$validateField(a,"name")]},null,8,["modelValue","rules"])]),u("div",za,[l(k,{style:{width:"40%"},label:"submit",type:"submit",color:"primary",rounded:"",onClick:re(s,["prevent"])})])])]),_:1})],64))}});var Za=Object.defineProperty,Xa=Object.getOwnPropertyDescriptor,el=(e,t,o,n)=>{for(var a=n>1?void 0:n?Xa(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&Za(t,o,a),a};class Nt extends Ne{id;name;lgaId}el([W({message:"LGA ward name is required"}),vt(2,{message:"LGA ward name must be at least 2 characters"}),bt(50,{message:"LGA ward name must be less than 50 characters"})],Nt.prototype,"name",2);el([W({message:"Select an LGA"})],Nt.prototype,"lgaId",2);const Ja={class:"flex row justify-between"},en={class:"flex row justify-center q-mt-lg"},tn=F({__name:"AddLgaWard",setup(e){F({name:"add-lga-ward"});const t=h([]),o=h(),n=_e("eventBus"),a=be();let s;const i=Ce(new Nt);Ue.handlePostLgaWard(n,{onSuccess:c,onError:C}),Be(async()=>{console.log("this is the lgaWardId: ",i.lgaId),i.validate()});const m=N(()=>t.value.map(T=>({label:T.name,value:T.id})));function d(){if(!Ee(i)){i.validate();return}a.loading.show({message:"Submitting ..."}),n.emit(U.POST_LGA_WARD,i),s=setTimeout(()=>{a.loading.hide()},je)}function c(){i.clearValues(),Z({loader:a.loading,timer:s})}function C(){Z({loader:a.loading,timer:s})}return ce(async()=>{t.value=await Ue.getLgas()}),pe(()=>{Z({loader:a.loading,timer:s})}),(T,O)=>(A(),G(le,null,[l(z,null,{default:r(()=>[u("div",Ja,[l(Oe,null,{default:r(()=>[ne("Add L.G.A. Ward")]),_:1}),l(st)])]),_:1}),l(z,null,{default:r(()=>[l(P(Fe),{ref_key:"lgaWardForm",ref:o},{default:r(()=>[u("div",null,[l(Y,{label:"Name",filled:"",outlined:"","label-color":"dark",modelValue:i.name,"onUpdate:modelValue":O[0]||(O[0]=b=>i.name=b),rules:[()=>T.$validateField(i,"name")]},null,8,["modelValue","rules"]),l(ie,{label:"Select L.G.A.",filled:"",outlined:"","label-color":"dark",modelValue:i.lgaId,"onUpdate:modelValue":O[1]||(O[1]=b=>i.lgaId=b),options:m.value,rules:[()=>T.$validateField(i,"lgaId")],"emit-value":"","map-options":"",clearable:""},{append:r(()=>[l(k,{flat:"",round:"",dense:"",icon:"add"})]),"no-option":r(()=>[l($e,null,{default:r(()=>[l(De,null,{default:r(()=>[l(k,{label:"Create L.G.A.",flat:"",dense:""})]),_:1})]),_:1})]),_:1},8,["modelValue","options","rules"])]),u("div",en,[l(k,{style:{width:"40%"},label:"submit",type:"submit",color:"primary",rounded:"",onClick:re(d,["prevent"])})])]),_:1},512)]),_:1})],64))}});var oe=(e=>(e.PROPERTIES="Properties",e.BILLINGS="Billings",e))(oe||{}),Ie=(e=>(e[e.ADD_SUBSCRIBER=0]="ADD_SUBSCRIBER",e[e.ADD_STREET=1]="ADD_STREET",e[e.ADD_PROPERTY_TYPE=2]="ADD_PROPERTY_TYPE",e))(Ie||{}),ke=(e=>(e[e.ADD_LGA=0]="ADD_LGA",e[e.ADD_LGA_WARD=1]="ADD_LGA_WARD",e))(ke||{});const ln=["top","right","bottom","left"],tl={type:{type:String,default:"a"},outline:Boolean,push:Boolean,flat:Boolean,unelevated:Boolean,color:String,textColor:String,glossy:Boolean,square:Boolean,padding:String,label:{type:[String,Number],default:""},labelPosition:{type:String,default:"right",validator:e=>ln.includes(e)},externalLabel:Boolean,hideLabel:{type:Boolean},labelClass:[Array,String,Object],labelStyle:[Array,String,Object],disable:Boolean,tabindex:[Number,String]};function ll(e,t){return{formClass:N(()=>`q-fab--form-${e.square===!0?"square":"rounded"}`),stacked:N(()=>e.externalLabel===!1&&["top","bottom"].includes(e.labelPosition)),labelProps:N(()=>{if(e.externalLabel===!0){const o=e.hideLabel===null?t.value===!1:e.hideLabel;return{action:"push",data:{class:[e.labelClass,`q-fab__label q-tooltip--style q-fab__label--external q-fab__label--external-${e.labelPosition}`+(o===!0?" q-fab__label--external-hidden":"")],style:e.labelStyle}}}return{action:["left","top"].includes(e.labelPosition)?"unshift":"push",data:{class:[e.labelClass,`q-fab__label q-fab__label--internal q-fab__label--internal-${e.labelPosition}`+(e.hideLabel===!0?" q-fab__label--internal-hidden":"")],style:e.labelStyle}}})}}const al={start:"self-end",center:"self-center",end:"self-start"},an=Object.keys(al);var nn=xe({name:"QFabAction",props:{...tl,icon:{type:String,default:""},anchor:{type:String,validator:e=>an.includes(e)},to:[String,Object],replace:Boolean},emits:["click"],setup(e,{slots:t,emit:o}){const n=_e(Qt,()=>({showing:{value:!0},onChildClick:hl})),{formClass:a,labelProps:s}=ll(e,n.showing),i=N(()=>{const T=al[e.anchor];return a.value+(T!==void 0?` ${T}`:"")}),m=N(()=>e.disable===!0||n.showing.value!==!0);function d(T){n.onChildClick(T),o("click",T)}function c(){const T=[];return t.icon!==void 0?T.push(t.icon()):e.icon!==""&&T.push(j(Me,{name:e.icon})),(e.label!==""||t.label!==void 0)&&T[s.value.action](j("div",s.value.data,t.label!==void 0?t.label():[e.label])),Ht(t.default,T)}const C=nt();return Object.assign(C.proxy,{click:d}),()=>j(k,{class:i.value,...e,noWrap:!0,stack:e.stacked,icon:void 0,label:void 0,noCaps:!0,fabMini:!0,disable:m.value,onClick:d},c)}});const on=["up","right","down","left"],rn=["left","center","right"];var sn=xe({name:"QFab",props:{...tl,...zt,icon:String,activeIcon:String,hideIcon:Boolean,hideLabel:{default:null},direction:{type:String,default:"right",validator:e=>on.includes(e)},persistent:Boolean,verticalActionsAlign:{type:String,default:"center",validator:e=>rn.includes(e)}},emits:Kt,setup(e,{slots:t}){const o=h(null),n=h(e.modelValue===!0),a=Nl(),{proxy:{$q:s}}=nt(),{formClass:i,labelProps:m}=ll(e,n),d=N(()=>e.persistent!==!0),{hide:c,toggle:C}=Zt({showing:n,hideOnRouteChange:d}),T=N(()=>({opened:n.value})),O=N(()=>`q-fab z-fab row inline justify-center q-fab--align-${e.verticalActionsAlign} ${i.value}`+(n.value===!0?" q-fab--opened":" q-fab--closed")),b=N(()=>`q-fab__actions flex no-wrap inline q-fab__actions--${e.direction} q-fab__actions--${n.value===!0?"opened":"closed"}`),M=N(()=>{const L={id:a,role:"menu"};return n.value!==!0&&(L["aria-hidden"]="true"),L}),_=N(()=>`q-fab__icon-holder  q-fab__icon-holder--${n.value===!0?"opened":"closed"}`);function v(L,X){const R=t[L],V=`q-fab__${L} absolute-full`;return R===void 0?j(Me,{class:V,name:e[X]||s.iconSet.fab[X]}):j("div",{class:V},R(T.value))}function $(){const L=[];return e.hideIcon!==!0&&L.push(j("div",{class:_.value},[v("icon","icon"),v("active-icon","activeIcon")])),(e.label!==""||t.label!==void 0)&&L[m.value.action](j("div",m.value.data,t.label!==void 0?t.label(T.value):[e.label])),Ht(t.tooltip,L)}return _l(Qt,{showing:n,onChildClick(L){c(L),o.value!==null&&o.value.$el.focus()}}),()=>j("div",{class:O.value},[j(k,{ref:o,class:i.value,...e,noWrap:!0,stack:e.stacked,align:void 0,icon:void 0,label:void 0,noCaps:!0,fab:!0,"aria-expanded":n.value===!0?"true":"false","aria-haspopup":"true","aria-controls":a,onClick:C},$),j("div",{class:b.value,...M.value},at(t.default))])}});const pt=F({__name:"AdvanceTableMenu",props:{menuItems:{default:()=>[]},padding:{default:"xs"}},emits:["menuItemClickHandler"],setup(e){return F({name:"advance-table-menu"}),(t,o)=>(A(),Q(sn,{color:"transparent","text-color":"black",icon:"keyboard_arrow_left",direction:"left",padding:"xs",margin:"xs"},{default:r(()=>[(A(!0),G(le,null,Ve(t.menuItems,n=>(A(),Q(nn,{key:n.label,icon:n.icon,color:n.color,"text-color":n.textColor,padding:"xs",onClick:a=>t.$emit("menuItemClickHandler",n)},{default:r(()=>[l($t,null,{default:r(()=>[ne(Ge(n.label),1)]),_:2},1024)]),_:2},1032,["icon","color","text-color","onClick"]))),128))]),_:1}))}});function lt(e,t=new WeakMap){if(Object(e)!==e)return e;if(t.has(e))return t.get(e);const o=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e instanceof Set?new Set:e instanceof Map?new Map:typeof e.constructor!="function"?Object.create(null):e.prototype!==void 0&&typeof e.prototype.constructor=="function"?e:new e.constructor;if(typeof e.constructor=="function"&&typeof e.valueOf=="function"){const n=e.valueOf();if(Object(n)!==n){const a=new e.constructor(n);return t.set(e,a),a}}return t.set(e,o),e instanceof Set?e.forEach(n=>{o.add(lt(n,t))}):e instanceof Map&&e.forEach((n,a)=>{o.set(a,lt(n,t))}),Object.assign(o,...Object.keys(e).map(n=>({[n]:lt(e[n],t)})))}var Ct=xe({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(e,{slots:t,emit:o}){const{proxy:n}=nt(),{$q:a}=n,s=h(null),i=h(""),m=h("");let d=!1;const c=N(()=>Pl({initialValue:i.value,validate:e.validate,set:C,cancel:T,updatePosition:O},"value",()=>m.value,R=>{m.value=R}));function C(){e.validate(m.value)!==!1&&(b()===!0&&(o("save",m.value,i.value),o("update:modelValue",m.value)),M())}function T(){b()===!0&&o("cancel",m.value,i.value),M()}function O(){wl(()=>{s.value.updatePosition()})}function b(){return Sl(m.value,i.value)===!1}function M(){d=!0,s.value.hide()}function _(){d=!1,i.value=lt(e.modelValue),m.value=lt(e.modelValue),o("beforeShow")}function v(){o("show")}function $(){d===!1&&b()===!0&&(e.autoSave===!0&&e.validate(m.value)===!0?(o("save",m.value,i.value),o("update:modelValue",m.value)):o("cancel",m.value,i.value)),o("beforeHide")}function L(){o("hide")}function X(){const R=t.default!==void 0?[].concat(t.default(c.value)):[];return e.title&&R.unshift(j("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},e.title)),e.buttons===!0&&R.push(j("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[j(k,{flat:!0,color:e.color,label:e.labelCancel||a.lang.label.cancel,onClick:T}),j(k,{flat:!0,color:e.color,label:e.labelSet||a.lang.label.set,onClick:C})])),R}return Object.assign(n,{set:C,cancel:T,show(R){s.value!==null&&s.value.show(R)},hide(R){s.value!==null&&s.value.hide(R)},updatePosition:O}),()=>{if(e.disable!==!0)return j(zl,{ref:s,class:"q-popup-edit",cover:e.cover,onBeforeShow:_,onShow:v,onBeforeHide:$,onHide:L,onEscapeKey:T},X)}}});async function nl({process:e,onError:t,loader:o,useNotifer:n=!0,notifierType:a="positive",notifierMessage:s,loaderMessage:i="Please, wait!",showErrorNotifier:m=!0}){o&&o.show({message:i});try{await e(),n&&se({type:a,...s?{message:s}:{}})}catch(d){const c=d;t==null||t(),m&&se({type:"negative",...c.message?{message:c.message}:{}})}finally{o!=null&&o.isActive&&o.hide()}}var un=Object.defineProperty,dn=Object.getOwnPropertyDescriptor,Bt=(e,t,o,n)=>{for(var a=n>1?void 0:n?dn(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&un(t,o,a),a};class ht extends Ne{amount;propertySubscriptionId;reason}Bt([W(),Ll({},{message:"Please, enter a valid amount in numbers."})],ht.prototype,"amount",2);Bt([W({message:"Property Subscription Reference not defined."})],ht.prototype,"propertySubscriptionId",2);Bt([W()],ht.prototype,"reason",2);const cn=u("div",{class:"text-h4"},"Edit Arrears",-1),pn={class:"q-pa-md"},mn=F({__name:"EditArrears",props:{amount:{},propertySubscriptionId:{}},emits:["updateAmount"],setup(e,{emit:t}){F({name:"edit-arrears"});const o=e,n=t,a=Ce(new ht),s=be();Be(()=>{a.validate()});async function i(){nl({loader:s.loading,process:async()=>{if(a.validate(),!Ee(a))throw console.log("Edit Areas model is invalid."),new Error("Edit Areas model is invalid.");await Dt.updateArrears({arrears:a.amount,propertySubscriptionId:a.propertySubscriptionId,reason:a.reason})},onError:()=>{console.log("Error saving arrears!")},loaderMessage:"Saving ...",notifierType:"positive",notifierMessage:"Process successful",showErrorNotifier:!0})}function m(d){n("updateAmount",d),a.amount=d}return ce(()=>{a.amount=o.amount,a.propertySubscriptionId=o.propertySubscriptionId}),(d,c)=>(A(),G("div",null,[l(ft,null,{default:r(()=>[l(z,null,{default:r(()=>[cn]),_:1}),l(z,null,{default:r(()=>[u("div",pn,[l(Fe,null,{default:r(()=>[l(Y,{"model-value":a.amount,"onUpdate:modelValue":m,label:"Amount",rules:[()=>d.$validateField(a,"amount")]},null,8,["model-value","rules"]),l(Y,{modelValue:a.reason,"onUpdate:modelValue":c[0]||(c[0]=C=>a.reason=C),label:"Reason",rules:[()=>d.$validateField(a,"reason")]},null,8,["modelValue","rules"]),l(k,{label:"Save",onClick:i})]),_:1})])]),_:1})]),_:1})]))}}),Ye=F({__name:"BorderedCard",props:{bgColor:{default:"secondary"},borderColor:{default:"primary"},borderStyle:{default:"solid"},borderWidth:{default:"0.1rem"},height:{default:"100%"}},setup(e){return F({name:"bordered-card"}),(t,o)=>(A(),Q(ft,{style:fe({borderColor:`${t.$getColor(t.borderColor)}`,borderStyle:`${t.borderStyle}`,borderWidth:`${t.borderWidth}`,backgroundColor:`${t.$getColor(t.bgColor)}`,height:t.height})},{default:r(()=>[l(z,null,{default:r(()=>[Il(t.$slots,"default")]),_:3})]),_:3},8,["style"]))}}),ol=6e4,rl=36e5,Ft=Symbol.for("constructDateFrom");function sl(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Ft in e?e[Ft](t):e instanceof Date?new e.constructor(t):new Date(t)}function jt(e,t){return sl(t||e,e)}function Tt(e,t){const o=()=>sl(t==null?void 0:t.in,NaN),n=(t==null?void 0:t.additionalDigits)??2,a=yn(e);let s;if(a.date){const c=gn(a.date,n);s=hn(c.restDateString,c.year)}if(!s||isNaN(+s))return o();const i=+s;let m=0,d;if(a.time&&(m=_n(a.time),isNaN(m)))return o();if(a.timezone){if(d=wn(a.timezone),isNaN(d))return o()}else{const c=new Date(i+m),C=jt(0,t==null?void 0:t.in);return C.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),C.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),C}return jt(i+m+d,t==null?void 0:t.in)}const dt={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},fn=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,vn=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,bn=/^([+-])(\d{2})(?::?(\d{2}))?$/;function yn(e){const t={},o=e.split(dt.dateTimeDelimiter);let n;if(o.length>2)return t;if(/:/.test(o[0])?n=o[0]:(t.date=o[0],n=o[1],dt.timeZoneDelimiter.test(t.date)&&(t.date=e.split(dt.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const a=dt.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function gn(e,t){const o=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(o);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?a:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function hn(e,t){if(t===null)return new Date(NaN);const o=e.match(fn);if(!o)return new Date(NaN);const n=!!o[4],a=ze(o[1]),s=ze(o[2])-1,i=ze(o[3]),m=ze(o[4]),d=ze(o[5])-1;if(n)return Tn(t,m,d)?Sn(t,m,d):new Date(NaN);{const c=new Date(0);return!In(t,s,i)||!Cn(t,a)?new Date(NaN):(c.setUTCFullYear(t,s,Math.max(a,i)),c)}}function ze(e){return e?parseInt(e):1}function _n(e){const t=e.match(vn);if(!t)return NaN;const o=Vt(t[1]),n=Vt(t[2]),a=Vt(t[3]);return Vn(o,n,a)?o*rl+n*ol+a*1e3:NaN}function Vt(e){return e&&parseFloat(e.replace(",","."))||0}function wn(e){if(e==="Z")return 0;const t=e.match(bn);if(!t)return 0;const o=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return An(n,a)?o*(n*rl+a*ol):NaN}function Sn(e,t,o){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,s=(t-1)*7+o+1-a;return n.setUTCDate(n.getUTCDate()+s),n}const Pn=[31,null,31,30,31,30,31,31,30,31,30,31];function il(e){return e%400===0||e%4===0&&e%100!==0}function In(e,t,o){return t>=0&&t<=11&&o>=1&&o<=(Pn[t]||(il(e)?29:28))}function Cn(e,t){return t>=1&&t<=(il(e)?366:365)}function Tn(e,t,o){return t>=1&&t<=53&&o>=0&&o<=6}function Vn(e,t,o){return e===24?t===0&&o===0:o>=0&&o<60&&t>=0&&t<60&&e>=0&&e<25}function An(e,t){return t>=0&&t<=59}const $n={class:"flex row justify-between q-mb-sm",style:{width:"100%",height:"12rem"}},Dn={style:{width:"49.5%"}},xn=u("div",{class:"text-center text-bolder text-h6"},[u("span",null,"Property")],-1),Nn={class:"q-my-lg"},Bn=u("span",null,"Id",-1),On={class:"q-my-lg"},En=u("span",null,"Name",-1),Ln={style:{width:"49.5%"}},kn=u("div",{class:"text-center text-bolder text-h6"},[u("span",null,"Transaction")],-1),Rn=u("span",null,"Arrears",-1),qn=u("span",null,"Last Payment",-1),Un=u("span",null,"Date of Payment",-1),Mn={style:{width:"100%",height:"8rem"}},Gn=u("div",null,[u("p",null,[u("span",null,"Street")])],-1),Fn={class:"flex row justify-evenly"},jn=u("span",null,"Number",-1),Wn=u("span",null,"Name",-1),Qn={style:{width:"100%",height:"8rem"}},Hn=u("div",null,[u("p",null,[u("span",null,"Custodian")])],-1),Yn={class:"flex row justify-evenly q-mt-md"},zn=u("span",null,"Name",-1),Kn=u("span",null,"Email",-1),Zn=u("span",null,"Phone",-1),Xn=u("br",null,null,-1),Jn={key:0},eo=u("span",null,"Payment Account",-1),to={style:{width:"100%",height:"auto"}},lo={class:"flex row text-bolder text-h6 flex items-center"},ao=u("div",{class:"flex row justify-end",style:{width:"50%"}},[u("span",null,"Billing Details")],-1),no={class:"flex row justify-end q-gutter-sm q-mb-sm",style:{width:"50%"}},oo={key:0},ro={key:1},so={key:2},io=u("div",null,null,-1),uo=F({__name:"ViewPropertyDetails",props:{dialogWidth:{default:30},propertySubscriptionId:{}},setup(e){const t=e;F({name:"view-property-details",components:{DialogCard:tt}});const o=be(),n=[{label:"Remove Row",icon:"remove",textColor:"black"}],a=[{field:"propertyTypeId",label:"Property Type Id",name:"propertyTypeId"},{field:"propertyType",label:"Property Type",name:"propertyType"},{field:"propertyUnit",label:"Property Units",name:"propertyUnit"},{field:"unitPrice",label:"Unit Price",name:"unitPrice"}],s=["propertyType","propertyUnit","unitPrice"],i=h([{propertyTypeId:"1",propertyType:"House",propertyUnit:"5",unitPrice:"N5000"}]),m=h([]),d=h(!1),c=h({}),C=h(-1),T=h(!1),O=h(""),b=h(!1);h(!1),h(!1);const M=h(""),_=N(()=>m.value.map(S=>({label:`${S.name} - ${S.unitPrice}`,value:S.id})));N(()=>{if(c.value.billingAccount){const S=Number(P(c.value).billingAccount.totalBillings)-Number(P(c.value).billingAccount.totalPayments);return"N"+S}else return"N0"});const v=N(()=>{const S=c.value.payments;if(S&&S.length>0){const I=P(c.value).payments.sort((y,E)=>Tt(E.createdAt).getTime()-Tt(y.createdAt).getTime())[0];return{createdAt:Tt(I.createdAt).toDateString(),amount:I.amount}}else return{createdAt:"--/--/--",amount:"N0"}}),$=N(()=>{var y,E;let S={email:"",name:"",phone:"",phoneCode:"",phoneCodeId:""};const I=c.value.entitySubscriberProfile;return I&&(S={email:I.email,name:I.firstName+I.lastName,phone:I.phone||"",phoneCode:((y=I.phoneCode)==null?void 0:y.name)||"234",phoneCodeId:((E=I.phoneCode)==null?void 0:E.id)||""}),S}),L=N(()=>c.value.streetNumber?{num:P(c.value).streetNumber,name:P(c.value).street.name}:{});async function X(S){await nl({loader:o.loading,process:async()=>{await ae.updatePropertyName({propertySubscriptionName:S,propertySubscriptionId:t.propertySubscriptionId})},loaderMessage:"Updating property name..."}),await x()}async function R(S){try{M.value=S;const I={...$.value.phoneCodeId?{phoneCodeId:$.value.phoneCodeId}:{phoneCode:$.value.phoneCode},phone:S,propertySubscriptionId:t.propertySubscriptionId};await Ae(he.UPDATE_PHONE,"put",{body:I}),se({type:"positive",message:"Phone number updated successfully"})}catch{se({type:"negative"})}}function V(S,I){console.log("the updated value is: -->",S);const y=m.value.find(E=>E.id===S.value);I.value=(y==null?void 0:y.name)||"",i.value[C.value].propertyTypeId=(y==null?void 0:y.id)||"",i.value[C.value].unitPrice=String((y==null?void 0:y.unitPrice)||"")}async function p(){m.value=await ae.getPropertyTypes()}async function D(){T.value=!0;try{await ae.savePropertyUnits({propertySubscriptionId:c.value.id,propertySubscriptionUnits:i.value}),se({type:"positive"})}catch{se({type:"negative"})}T.value=!1,d.value=!1}function H(){i.value.push({propertyTypeId:"",propertyType:"",propertyUnit:"",unitPrice:""})}function me(S){i.value.splice(S,1)}function B(S){C.value=S}async function x(){c.value=await ae.getPropertySubscriptionDetails(t.propertySubscriptionId)}function q(){b.value=!b.value}return de(()=>$.value.phone,async S=>{S&&(M.value=S)}),de(c,S=>{if(S){const I=Number(P(c.value).billingAccount.totalBillings)-Number(P(c.value).billingAccount.totalPayments);O.value=""+I}}),de(c,S=>{S&&(i.value=c.value.propertySubscriptionUnits.map(I=>({propertyTypeId:I.entitySubscriberProperty.propertyType.id,propertyType:I.entitySubscriberProperty.propertyType.name,propertyUnit:I.propertyUnits,unitPrice:I.entitySubscriberProperty.propertyType.unitPrice})))}),ce(async()=>{await x()}),(S,I)=>(A(),Q(tt,{height:"auto",width:`${S.dialogWidth}rem`},{default:r(()=>[l(z,{class:"q-pa-lg flex column q-gutter-sm moderate-modal-font"},{default:r(()=>[u("div",$n,[u("div",Dn,[l(Ye,null,{default:r(()=>[xn,u("div",null,[u("p",Nn,[Bn,l(te,{class:"q-ml-sm q-pa-sm q-px-sm",label:c.value.id,rounded:""},null,8,["label"])]),u("p",On,[En,l(te,{class:"q-ml-sm q-pa-sm q-px-sm",label:c.value.propertySubscriptionName,rounded:""},{default:r(()=>[l(Ct,{modelValue:c.value.propertySubscriptionName,"onUpdate:modelValue":I[0]||(I[0]=y=>c.value.propertySubscriptionName=y),title:"Edit Property Name","auto-save":""},{default:r(y=>[l(Y,{modelValue:y.value,"onUpdate:modelValue":E=>y.value=E,dense:"",autofocus:"",counter:"",onKeyup:It(E=>X(y.value),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"]),l(Me,{name:"edit",class:"q-ml-sm cursor-pointer text-subtitle1"})]),_:1},8,["label"])])])]),_:1})]),u("div",Ln,[l(Ye,null,{default:r(()=>[kn,u("div",null,[u("p",null,[Rn,l(k,{flat:"",padding:"0",onClick:q},{default:r(()=>[l(Bl,{class:"q-ml-sm q-pa-sm q-px-sm",label:"N"+O.value,rounded:"",color:"primary","text-color":"white","icon-right":"edit"},null,8,["label"])]),_:1}),l(Xe,{modelValue:b.value,"onUpdate:modelValue":I[2]||(I[2]=y=>b.value=y)},{default:r(()=>[u("div",null,[l(mn,{amount:O.value,"property-subscription-id":S.propertySubscriptionId,onUpdateAmount:I[1]||(I[1]=y=>O.value=y)},null,8,["amount","property-subscription-id"])])]),_:1},8,["modelValue"])]),u("p",null,[qn,l(te,{class:"q-ml-sm q-pa-sm q-px-sm",label:v.value.amount,rounded:""},null,8,["label"])]),u("p",null,[Un,l(te,{class:"q-ml-sm q-pa-sm q-px-sm",label:v.value.createdAt,rounded:""},null,8,["label"])])])]),_:1})])]),u("div",Mn,[l(Ye,null,{default:r(()=>[Gn,u("div",Fn,[u("p",null,[jn,l(te,{class:"q-ml-sm q-pa-sm q-px-sm",label:L.value.num,rounded:""},null,8,["label"])]),u("p",null,[Wn,l(te,{class:"q-ml-sm q-pa-sm q-px-sm",label:L.value.name,rounded:""},null,8,["label"])])])]),_:1})]),u("div",Qn,[l(Ye,null,{default:r(()=>{var y,E,Se;return[Hn,u("div",Yn,[u("p",null,[zn,l(te,{class:"q-ml-sm q-pa-sm q-px-sm",label:$.value.name,rounded:""},null,8,["label"])]),u("p",null,[Kn,l(te,{class:"q-ml-sm q-pa-sm q-px-sm",label:$.value.email,rounded:""},null,8,["label"])]),u("p",null,[Zn,l(te,{class:"q-ml-sm q-pa-sm q-px-sm",label:$.value.phoneCode,rounded:""},null,8,["label"]),l(te,{class:"q-ml-sm q-pa-sm q-px-sm",label:$.value.phone,rounded:""},{default:r(()=>[l(Ct,{modelValue:M.value,"onUpdate:modelValue":I[3]||(I[3]=J=>M.value=J),title:"Edit Phone Number","auto-save":""},{default:r(J=>[l(Y,{modelValue:J.value,"onUpdate:modelValue":ve=>J.value=ve,dense:"",autofocus:"",counter:"",onKeyup:It(ve=>R(J.value),["enter"]),rules:[ve=>ve.length===10||"Please enter a valid phone number"]},null,8,["modelValue","onUpdate:modelValue","onKeyup","rules"])]),_:1},8,["modelValue"]),l(Me,{name:"edit",class:"q-ml-sm cursor-pointer text-subtitle1"})]),_:1},8,["label"])]),Xn,((y=c.value.subscriberVirtualAccountDetails)==null?void 0:y.length)>0?(A(),G("p",Jn,[eo,l(te,{class:"q-ml-sm q-pa-sm q-px-sm",label:(E=c.value.subscriberVirtualAccountDetails)==null?void 0:E[0].account_name,rounded:""},null,8,["label"]),l(te,{class:"q-ml-sm q-pa-sm q-px-sm",label:(Se=c.value.subscriberVirtualAccountDetails)==null?void 0:Se[0].account_number,rounded:""},null,8,["label"])])):ue("",!0)])]}),_:1})]),u("div",to,[l(Ye,null,{default:r(()=>[u("div",lo,[ao,u("div",no,[d.value?ue("",!0):(A(),G("span",oo,[l(k,{icon:"edit",round:"",onClick:I[4]||(I[4]=y=>d.value=!0)})])),d.value?(A(),G("span",ro,[l(k,{icon:"add",round:"",onClick:H})])):ue("",!0),d.value?(A(),G("span",so,[l(k,{icon:"save",round:"",onClick:D})])):ue("",!0)])]),u("div",null,[l(Ze,{bordered:"",column:a,rows:i.value,"visible-columns":s,"table-header-class":"text-bolder","table-header-style":{backgroundColor:`${S.$getColor("secondary")}`},loading:T.value,"sort-method":y=>y,onRowClick:I[6]||(I[6]=y=>console.log("row with the following data was clicked: ",y))},{header:r(y=>[l(qe,{props:y},{default:r(()=>[(A(!0),G(le,null,Ve(y.cols,E=>(A(),Q(El,{key:E.name,props:y,style:{textAlign:"left"}},{default:r(()=>[ne(Ge(E.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:r(y=>[l(qe,{props:y,onMouseenter:E=>B(y.rowIndex)},{default:r(()=>[(A(!0),G(le,null,Ve(y.cols,(E,Se)=>(A(),Q(Je,{key:E.name,class:"text-left",style:{postion:"relative"}},{default:r(()=>[E.name==="propertyType"?(A(),G(le,{key:0},[ne(Ge(y.row[E.name])+" ",1),l(Ct,{modelValue:y.row[E.name],"onUpdate:modelValue":J=>y.row[E.name]=J,title:"Edit the Property Type","auto-save":""},{default:r(J=>[l(ie,{filled:"","model-value":J.value,options:_.value,"use-input":"","input-debounce":"0",style:{width:"250px"},disable:!d.value,onKeyup:It(J.set,["enter"]),onPopupShow:p,"onUpdate:modelValue":ve=>V(ve,J)},{"no-option":r(()=>[l($e,null,{default:r(()=>[l(De,{class:"text-grey"},{default:r(()=>[ne(" No results ")]),_:1})]),_:1})]),_:2},1032,["model-value","options","disable","onKeyup","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue"])],64)):(A(),G(le,{key:1},[l(Y,{modelValue:y.row[E.name],"onUpdate:modelValue":J=>y.row[E.name]=J,type:"text",dense:"",borderless:"",disable:!d.value},null,8,["modelValue","onUpdate:modelValue","disable"]),Se===y.cols.length-1?Re((A(),G("span",{key:0,style:fe({position:"absolute",top:C.value===y.rowIndex?"0.5rem":"0",right:C.value===y.rowIndex?"0.5rem":"0",zIndex:C.value===y.rowIndex?"1":"0"})},[l(pt,{"menu-items":n,onMenuItemClickHandler:I[5]||(I[5]=()=>me(C.value))})],4)),[[Ke,C.value===y.rowIndex]]):ue("",!0)],64))]),_:2},1024))),128))]),_:2},1032,["props","onMouseenter"])]),_:1},8,["rows","table-header-style","loading","sort-method"])]),io]),_:1})])]),_:1})]),_:1},8,["width"]))}});const co={class:"row justify-between items-center"},po={class:"q-mt-xl"},mo={class:"q-mt-lg",style:{height:"70vh"}},fo={class:"q-mb-lg",style:{width:"20rem"}},ct=80,Fo=F({__name:"PropertyBillingPage",setup(e){const t=be(),o=Rl("light-page")||"#ffffff",n=_e("eventBus"),a=[{label:"View Details",icon:"visibility",textColor:"black"},{label:"Get Defaulters",icon:"paid",textColor:"black"}],s=[{label:"View Details",icon:"visibility",textColor:"black"},{label:"View Payments",icon:"paid",textColor:"black"}],i=[{label:"Delete",icon:"remove",textColor:"black"}];ae.handlePaginateSubscription(n,{onSuccess:_t,onError:wt});const m=mt[new Date().getMonth()+1],d=[{field:"propertySubscriptionId",label:"Property Subscription Id",name:"propertySubscriptionId",align:"left"},{field:"propertyName",label:"Property Name",name:"propertyName",align:"left"},{field:"oldCode",label:"Old Code",name:"oldCode",align:"left"},{field:"streetNumber",label:"Street Number",name:"streetNumber",align:"left"},{field:"streetName",label:"Street Name",name:"streetName",align:"left"},{field:"arrears",label:"Arrears",name:"arrears",align:"left"}],c=[{field:"streetId",name:"streetId",label:"streetId",align:"center"},{field:"streetName",label:"Street Name",name:"streetName",align:"center"},{field:"arrears",label:"Arrears",name:"arrears",align:"center"},{field:"totalBilling",label:"Total Billing",name:"totalBilling",align:"center"},{field:"actions",label:"Actions",name:"actions",align:"center"}],C=[{field:"streetName",label:"Street Name",name:"streetName",align:"center"},{field:"propertyName",label:"Property Name",name:"propertyName",align:"center"},{field:"currentBilling",label:"Current Billing",name:"currentBilling",align:"center"},{field:"currentBillingId",label:"Current Billing",name:"currentBillingId",align:"center"},{field:"arrears",label:"Arrears",name:"arrears",align:"center"}],T=[...C,{field:"totalBilling",label:"Total Billing",name:"totalBilling",align:"center"},{field:"lastPayment",label:"Last Payment",name:"lastPayment",align:"center"}],O=["streetName","arrears","totalBilling"],b=C.filter(w=>w.name!=="currentBillingId").map(w=>w.field),M=[...b,"totalBilling","lastPayment"],_={billing:"billing",billingDetails:"billingDetails",billingDefaulters:"defaulters"};et.handleViewBillingDetails(n,{onSuccess:ul}),et.handleGetDefaulters(n,{onSuccess:dl});const v=h(oe.PROPERTIES),$=h(!1),L=h(m),X=h(!1),R=h(!1),V=h(Ie.ADD_SUBSCRIBER),p=h(ke.ADD_LGA),D=h(),H=h(-1);let me=h([]);const B=h("billing"),x=h([]),q=h({page:1,rowsPerPage:3,rowsNumber:10}),S=h(!0),I=h(""),y=h(!1);let E=h();const Se=N(()=>Object.values(mt).map(w=>w)),J=N(()=>({[oe.PROPERTIES]:"Add New Property",[oe.BILLINGS]:"Generate / Print Billing"})[v.value]),ve=N(()=>{var w;return(w=D.value)==null?void 0:w.map(f=>({propertySubscriptionId:f.propertySubscriptionId,propertyName:f.propertySubscriptionName,oldCode:f.oldCode,streetNumber:f.streetNumber,streetName:f.streetName,arrears:f.arrears}))}),it=N(()=>{var w;return(w=me.value)==null?void 0:w.map(f=>({streetName:f.streetName,arrears:f.arrears,streetId:f.streetId,totalBilling:f.totalBilling}))});function _t(w){se({type:"positive"}),D.value=w==null?void 0:w.data,q.value=w==null?void 0:w.pagination}function wt(){se({type:"negative",message:"Could not load more data!"})}async function ee(w){S.value=!0;const f=await ae.getSubscriptionByPages(w);D.value=f==null?void 0:f.data,q.value=f==null?void 0:f.pagination,S.value=!1}async function We(w,f){f==="View Details"?(E.value=w,y.value=!0):alert("This feature is under development.")}async function ge(w,f){try{w==="Delete"&&(t.loading.show({message:"Deleting ..."}),await Dt.deleteBilling(f),se({type:"positive",message:"Process successful!"}),t.loading.hide(),window.location.reload())}catch{se({type:"negative"}),t.loading.hide()}}async function ut(w,f){f&&(console.log("payload",f),w==="View Details"?n.emit(U.VIEW_BILLING_DETAILS,{streetId:f,billingMonth:L.value}):w==="Get Defaulters"&&n.emit(U.GET_DEFAULTERS,{streetId:f}))}function ul(w){B.value=_.billingDetails,x.value=w}function dl(w){B.value=_.billingDefaulters,x.value=w}function Pe(w){H.value=w}function cl(){$.value=!$.value}function St(w){X.value=!0,V.value=w}return n.on(U.TRIGGER_REMOTE_MODAL_LGA,()=>{p.value=ke.ADD_LGA,R.value=!0}),n.on(U.TRIGGER_REMOTE_MODAL_LGA_WARD,()=>{p.value=ke.ADD_LGA_WARD,R.value=!0}),de(I,async w=>{if(w){S.value=!0;const f=await ae.getSubscriptionByPages({pagination:q.value,filter:I.value});D.value=f==null?void 0:f.data,q.value=f==null?void 0:f.pagination,S.value=!1}}),Cl(async()=>{v.value===oe.PROPERTIES&&(me.value=await et.getBillingAccountArrears({page:1,limit:200}))}),de(L,async()=>{v.value===oe.BILLINGS&&(me.value=await et.getBillingAccountArrears({page:1,limit:200,month:L.value}))}),Tl(()=>{t.loading.show({message:"Please, wait ..."})}),ce(()=>{t.loading.hide()}),ce(async()=>{const w=await ae.getSubscriptions();D.value=w==null?void 0:w.data,q.value=w==null?void 0:w.pagination,S.value=!1}),pe(async()=>{n.off(U.VIEW_BILLING_DETAILS),n.off(U.GET_DEFAULTERS),n.off(U.PAGINATE_SUBSCRIPTION_TABLE)}),(w,f)=>(A(),Q(kl,null,{default:r(()=>[u("div",{style:fe({backgroundColor:P(o),height:"100vh",padding:"0 1rem",width:"100%"})},[u("div",co,[u("div",po,[l(ml,{modelValue:v.value,"onUpdate:modelValue":f[0]||(f[0]=g=>v.value=g),dense:"","active-color":"dark","active-bg-color":"secondary"},{default:r(()=>[l(Ot,{name:P(oe).PROPERTIES,icon:"house",label:P(oe).PROPERTIES,style:{width:"15rem"}},null,8,["name","label"]),l(Ot,{name:P(oe).BILLINGS,icon:"receipt",label:P(oe).BILLINGS,style:{width:"15rem"}},null,8,["name","label"])]),_:1},8,["modelValue"])]),u("div",null,[l(k,{color:"primary",rounded:"","no-caps":"",onClick:cl},{default:r(()=>[ne(Ge(J.value),1)]),_:1})])]),u("div",mo,[l(fl,{modelValue:v.value,"onUpdate:modelValue":f[9]||(f[9]=g=>v.value=g),style:{"background-color":"inherit",height:"100%"}},{default:r(()=>[l(Et,{name:P(oe).PROPERTIES},{default:r(()=>[u("div",null,[l(ft,{rounded:"",class:"bg-accent"},{default:r(()=>[l(z,null,{default:r(()=>[l(Ze,{class:"header-sticky",rows:ve.value,bordered:"",columns:d,"table-header-style":{backgroundColor:`${w.$getColor("secondary")}`},onRequest:ee,pagination:q.value,"onUpdate:pagination":f[3]||(f[3]=g=>q.value=g),loading:S.value,filter:I.value},{"top-right":r(()=>[l(Y,{borderless:"",dense:"",debounce:"300",modelValue:I.value,"onUpdate:modelValue":f[1]||(f[1]=g=>I.value=g),placeholder:"Search"},{append:r(()=>[l(Me,{name:"search"})]),_:1},8,["modelValue"])]),body:r(g=>[l(qe,{props:g,onMouseenter:K=>Pe(g.rowIndex),onMouseleave:f[2]||(f[2]=K=>Pe(-1))},{default:r(()=>[(A(!0),G(le,null,Ve(g.cols,(K,Qe)=>(A(),Q(Je,{key:K.name},{default:r(()=>[l(te,{label:K.value,class:"text-bold",style:fe({backgroundColor:"transparent",color:`${w.$getColor("dark")}`})},null,8,["label","style"]),Qe===g.cols.length-1?Re((A(),G("span",{key:0,style:fe({position:"absolute",top:H.value===g.rowIndex?"0.5rem":"0",right:H.value===g.rowIndex?"0.5rem":"0",zIndex:H.value===g.rowIndex?"1":"0"})},[l(pt,{"menu-items":s,onMenuItemClickHandler:He=>We(g.row.propertySubscriptionId,He.label)},null,8,["onMenuItemClickHandler"])],4)),[[Ke,H.value===g.rowIndex]]):ue("",!0)]),_:2},1024))),128))]),_:2},1032,["props","onMouseenter"])]),_:1},8,["rows","table-header-style","pagination","loading","filter"])]),_:1})]),_:1})])]),_:1},8,["name"]),l(Et,{name:P(oe).BILLINGS},{default:r(()=>[u("div",fo,[l(ie,{style:{width:"100%"},modelValue:L.value,"onUpdate:modelValue":f[4]||(f[4]=g=>L.value=g),label:"Month",filled:"",outlined:"","label-color":"dark",options:Se.value,clearable:"","map-options":"","emit-value":""},null,8,["modelValue","options"])]),u("div",null,[l(ft,{rounded:"",class:"bg-accent"},{default:r(()=>[Re(l(z,null,{default:r(()=>[l(k,{icon:"arrow_back",flat:"",onClick:f[5]||(f[5]=g=>B.value=_.billing)})]),_:1},512),[[Ke,B.value!==_.billing]]),l(z,null,{default:r(()=>[B.value===_.billing?(A(),Q(Ze,{key:0,bordered:"",columns:c,rows:it.value,"visible-columns":O,"table-header-class":"text-bolder","table-header-style":{backgroundColor:`${w.$getColor("secondary")}`}},{body:r(g=>[l(qe,{props:g,onMouseenter:K=>Pe(g.rowIndex),onMouseleave:f[6]||(f[6]=K=>Pe(-1))},{default:r(()=>[(A(!0),G(le,null,Ve(g.cols,(K,Qe)=>(A(),Q(Je,{key:K.name,class:"text-center",style:{postion:"relative"}},{default:r(()=>[l(te,{label:K.value,class:"text-bold",style:fe({backgroundColor:"transparent",color:`${w.$getColor("dark")}`})},null,8,["label","style"]),Qe===g.cols.length-1?Re((A(),G("span",{key:0,style:fe({position:"absolute",top:H.value===g.rowIndex?"0.5rem":"0",right:H.value===g.rowIndex?"0.5rem":"0",zIndex:H.value===g.rowIndex?"1":"0"})},[l(pt,{"menu-items":a,onMenuItemClickHandler:He=>ut(He.label,g.row.streetId)},null,8,["onMenuItemClickHandler"])],4)),[[Ke,H.value===g.rowIndex]]):ue("",!0)]),_:2},1024))),128))]),_:2},1032,["props","onMouseenter"])]),_:1},8,["rows","table-header-style"])):B.value===_.billingDefaulters?(A(),Q(Ze,{key:1,bordered:"",columns:C,rows:x.value,"visible-columns":P(b),"table-header-class":"text-bolder","table-header-style":{backgroundColor:`${w.$getColor("secondary")}`},title:"Billings Payment Defaulters"},{body:r(g=>[l(qe,{props:g,onMouseenter:K=>Pe(g.rowIndex),onMouseleave:f[7]||(f[7]=K=>Pe(-1))},{default:r(()=>[(A(!0),G(le,null,Ve(g.cols,K=>(A(),Q(Je,{key:K.name,class:"text-center",style:{postion:"relative"}},{default:r(()=>[l(te,{label:K.value,class:"text-bold",style:fe({backgroundColor:"transparent",color:`${w.$getColor("dark")}`})},null,8,["label","style"])]),_:2},1024))),128))]),_:2},1032,["props","onMouseenter"])]),_:1},8,["rows","visible-columns","table-header-style"])):B.value===_.billingDetails?(A(),Q(Ze,{key:2,bordered:"",columns:T,rows:x.value,"visible-columns":M,"table-header-class":"text-bolder","table-header-style":{backgroundColor:`${w.$getColor("secondary")}`},title:"Billing Details"},{body:r(g=>[l(qe,{props:g,onMouseenter:K=>Pe(g.rowIndex),onMouseleave:f[8]||(f[8]=K=>Pe(-1))},{default:r(()=>[(A(!0),G(le,null,Ve(g.cols,(K,Qe)=>(A(),Q(Je,{key:K.name,class:"text-center",style:{postion:"relative"}},{default:r(()=>[l(te,{label:K.value,class:"text-bold",style:fe({backgroundColor:"transparent",color:`${w.$getColor("dark")}`})},null,8,["label","style"]),Qe===g.cols.length-1?Re((A(),G("span",{key:0,style:fe({position:"absolute",top:H.value===g.rowIndex?"0.5rem":"0",right:H.value===g.rowIndex?"0.5rem":"0",zIndex:H.value===g.rowIndex?"1":"0"})},[l(pt,{"menu-items":i,onMenuItemClickHandler:He=>ge(He.label,g.row.currentBillingId)},null,8,["onMenuItemClickHandler"])],4)),[[Ke,H.value===g.rowIndex]]):ue("",!0)]),_:2},1024))),128))]),_:2},1032,["props","onMouseenter"])]),_:1},8,["rows","table-header-style"])):ue("",!0)]),_:1})]),_:1})])]),_:1},8,["name"])]),_:1},8,["modelValue"])]),l(Xe,{modelValue:$.value,"onUpdate:modelValue":f[13]||(f[13]=g=>$.value=g)},{default:r(()=>[l(tt,{height:"auto",width:`${ct}rem`},{default:r(()=>[v.value===P(oe).PROPERTIES?(A(),Q(ma,{key:0,onAddSubscriber:f[10]||(f[10]=g=>St(P(Ie).ADD_SUBSCRIBER)),onAddStreet:f[11]||(f[11]=g=>St(P(Ie).ADD_STREET)),onAddPropertyType:f[12]||(f[12]=g=>St(P(Ie).ADD_PROPERTY_TYPE))})):v.value===P(oe).BILLINGS?(A(),Q(Ca,{key:1})):ue("",!0)]),_:1},8,["width"])]),_:1},8,["modelValue"]),l(Xe,{modelValue:X.value,"onUpdate:modelValue":f[14]||(f[14]=g=>X.value=g),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[l(tt,{height:"auto",width:`${ct-30}rem`},{default:r(()=>[V.value===P(Ie).ADD_SUBSCRIBER?(A(),Q(Oa,{key:0})):V.value===P(Ie).ADD_STREET?(A(),Q(Ua,{key:1})):V.value===P(Ie).ADD_PROPERTY_TYPE?(A(),Q(ja,{key:2})):ue("",!0)]),_:1},8,["width"])]),_:1},8,["modelValue"]),l(Xe,{modelValue:R.value,"onUpdate:modelValue":f[15]||(f[15]=g=>R.value=g),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[l(tt,{height:"auto",width:`${ct}rem`},{default:r(()=>[p.value===P(ke).ADD_LGA?(A(),Q(Ka,{key:0})):p.value===P(ke).ADD_LGA_WARD?(A(),Q(tn,{key:1})):ue("",!0)]),_:1},8,["width"])]),_:1},8,["modelValue"]),l(Xe,{modelValue:y.value,"onUpdate:modelValue":f[16]||(f[16]=g=>y.value=g)},{default:r(()=>[l(uo,{dialogWidth:ct,"property-subscription-id":P(E)},null,8,["property-subscription-id"])]),_:1},8,["modelValue"])],4)]),_:1}))}});export{Fo as default};
