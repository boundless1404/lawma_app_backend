import{M as mt,a as ft,P as pl,Q as Ot,b as ml,c as Et,d as fl}from"./PropertyType.model.a8586779.js";import{bK as Ve,c as x,h as M,bL as tt,g as lt,r as P,w as pe,aI as ie,c1 as Lt,c0 as kt,ca as vl,bo as bl,bX as gl,d as q,i as be,cn as Wt,C as Se,o as se,aQ as A,ae as U,f as l,bj as r,F as J,al as te,O as I,bH as ne,af as u,bS as L,co as Re,cs as Pt,cm as yl,X as Ue,W as ue,U as Rt,bl as Oe,ac as j,cd as hl,ct as Qt,bP as Ht,aS as _l,aW as Ie,aF as wl,cu as Sl,c4 as Pl,aX as Il,bG as It,ad as de,bF as Ye,bf as Cl,aH as Tl}from"./index.e12bd1bb.js";import{V as Vl,g as Al,a as $l,b as Dl,c as xl,B as Ae,I as G,d as $e,E as R,Q as qe,e as Q,u as Nl,f as Bl}from"./index.53d7a490.js";import{Q as ae}from"./QBadge.f7fd89d1.js";import{u as Yt,_ as De,l as Me,a as ce,m as ct,y as Ol,L as ke,b as Je,Q as ze,c as El}from"./DialogCard.988e108b.js";import{a as H,Q as pt}from"./QCard.86d96aa4.js";import{u as me,P as ee,Q as oe,I as Ll,a as Ke}from"./PropertySubscription.handler.63197773.js";import{Q as kl}from"./QPage.edf0ed22.js";import{g as Rl}from"./get-css-var.23548d6a.js";import{u as Ul,a as ql,v as Ut,b as Ml,d as Gl,e as Fl,f as jl,h as Wl,i as Ql,r as qt,s as Hl,p as Mt,j as Yl,Q as zl}from"./QMenu.96e4a9ed.js";import{u as zt,b as Kt,d as Kl,e as Zt,c as Gt,Q as Ce,a as Te}from"./use-timeout.0bc24682.js";import{Q as At,u as Zl,a as Xl,b as Jl}from"./QCheckbox.3061206e.js";import{c as z,i as xe}from"./utils.01331f21.js";import{api as Xt}from"./axios.75fdcab1.js";import{U as we}from"./urlPaths.enum.6eeee43a.js";import{r as Ee}from"./default.request.2e007412.js";import{u as ea}from"./billing-store.76379a15.js";import{I as ta}from"./IsEmail.3f45ee9e.js";import{C as la}from"./ClosePopup.2dd4fada.js";import"./QResizeObserver.11f8e167.js";import"./use-dark.62d118e9.js";import"./touch.3df10340.js";import"./focus-manager.02955f48.js";import"./QSeparator.0051c1d1.js";import"./QList.3165c0e2.js";import"./storeforage.b816bd1a.js";import"./format.ab7d224c.js";var Ze=Ve({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(e,{slots:t}){const o=lt(),n=x(()=>"q-td"+(e.autoWidth===!0?" q-table--col-auto-width":"")+(e.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(e.props===void 0)return M("td",{class:n.value},tt(t.default));const a=o.vnode.key,s=(e.props.colsMap!==void 0?e.props.colsMap[a]:null)||e.props.col;if(s===void 0)return;const{row:i}=e.props;return M("td",{class:n.value+s.__tdClass(i),style:s.__tdStyle(i)},tt(t.default))}}}),Le=Ve({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:t}){const o=x(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>M("tr",{class:o.value},tt(t.default))}}),$t=Ve({name:"QTooltip",inheritAttrs:!1,props:{...Ul,...zt,...ql,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:Ut},self:{type:String,default:"top middle",validator:Ut},offset:{type:Array,default:()=>[14,14],validator:Ml},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0}},emits:[...Kt],setup(e,{slots:t,emit:o,attrs:n}){let a,s;const i=lt(),{proxy:{$q:m}}=i,d=P(null),p=P(!1),C=x(()=>Mt(e.anchor,m.lang.rtl)),T=x(()=>Mt(e.self,m.lang.rtl)),B=x(()=>e.persistent!==!0),{registerTick:y,removeTick:F}=Gl(),{registerTimeout:w}=Kl(),{transitionProps:g,transitionStyle:$}=Fl(e),{localScrollTarget:E,changeScrollEvent:K,unconfigureScrollTarget:k}=jl(e,rt),{anchorEl:V,canShow:c,anchorEvents:D}=Wl({showing:p,configureAnchorEl:ht}),{show:W,hide:re}=Zt({showing:p,canShow:c,handleShow:b,handleHide:O,hideOnRouteChange:B,processOnMount:!0});Object.assign(D,{delayShow:Ge,delayHide:yt});const{showPortal:N,hidePortal:f,renderPortal:h}=Ql(i,d,wt,"tooltip");if(m.platform.is.mobile===!0){const X={anchorEl:V,innerRef:d,onClickOutside(ve){return re(ve),ve.target.classList.contains("q-dialog__backdrop")&&gl(ve),!0}},Fe=x(()=>e.modelValue===null&&e.persistent!==!0&&p.value===!0);pe(Fe,ve=>{(ve===!0?Yl:qt)(X)}),ie(()=>{qt(X)})}function b(X){N(),y(()=>{s=new MutationObserver(()=>Z()),s.observe(d.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),Z(),rt()}),a===void 0&&(a=pe(()=>m.screen.width+"|"+m.screen.height+"|"+e.self+"|"+e.anchor+"|"+m.lang.rtl,Z)),w(()=>{N(!0),o("show",X)},e.transitionDuration)}function O(X){F(),f(),ye(),w(()=>{f(!0),o("hide",X)},e.transitionDuration)}function ye(){s!==void 0&&(s.disconnect(),s=void 0),a!==void 0&&(a(),a=void 0),k(),Lt(D,"tooltipTemp")}function Z(){Hl({targetEl:d.value,offset:e.offset,anchorEl:V.value,anchorOrigin:C.value,selfOrigin:T.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function Ge(X){if(m.platform.is.mobile===!0){Gt(),document.body.classList.add("non-selectable");const Fe=V.value,ve=["touchmove","touchcancel","touchend","click"].map(st=>[Fe,st,"delayHide","passiveCapture"]);kt(D,"tooltipTemp",ve)}w(()=>{W(X)},e.delay)}function yt(X){m.platform.is.mobile===!0&&(Lt(D,"tooltipTemp"),Gt(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),w(()=>{re(X)},e.hideDelay)}function ht(){if(e.noParentEvent===!0||V.value===null)return;const X=m.platform.is.mobile===!0?[[V.value,"touchstart","delayShow","passive"]]:[[V.value,"mouseenter","delayShow","passive"],[V.value,"mouseleave","delayHide","passive"]];kt(D,"anchor",X)}function rt(){if(V.value!==null||e.scrollTarget!==void 0){E.value=vl(V.value,e.scrollTarget);const X=e.noParentEvent===!0?Z:re;K(E.value,X)}}function _t(){return p.value===!0?M("div",{...n,ref:d,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",n.class],style:[n.style,$.value],role:"tooltip"},tt(t.default)):null}function wt(){return M(bl,g.value,_t)}return ie(ye),Object.assign(i.proxy,{updatePosition:Z}),h}});function at(e){return function(t,o){var n={type:Vl.CONDITIONAL_VALIDATION,target:t.constructor,propertyName:o,constraints:[function(a,s){return a[o]!==null&&a[o]!==void 0}],validationOptions:e};Al().addValidationMetadata(new $l(n))}}var aa="isBoolean";function na(e){return e instanceof Boolean||typeof e=="boolean"}function oa(e){return Dl({name:aa,validator:{validate:function(t,o){return na(t)},defaultMessage:xl(function(t){return t+"$property must be a boolean value"},e)}},e)}var ra=Object.defineProperty,sa=Object.getOwnPropertyDescriptor,ge=(e,t,o,n)=>{for(var a=n>1?void 0:n?sa(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&ra(t,o,a),a};class fe extends Ae{id;propertyName;propertyUnit;expectedMonthlyCost;propertyTypeId;streetId;streetNumber;oldCode;propertySubscriberProfileId;isOwner=!1}ge([G({message:"Please, enter the property name"})],fe.prototype,"propertyName",2);ge([G({message:"Please, enter the property unit"})],fe.prototype,"propertyUnit",2);ge([at()],fe.prototype,"expectedMonthlyCost",2);ge([G({message:"Please, select the property type"})],fe.prototype,"propertyTypeId",2);ge([G({message:"Please, select the street"})],fe.prototype,"streetId",2);ge([G({message:"Please, enter the street number"})],fe.prototype,"streetNumber",2);ge([at()],fe.prototype,"oldCode",2);ge([G({message:"Please, select a custiodian"})],fe.prototype,"propertySubscriberProfileId",2);ge([oa()],fe.prototype,"isOwner",2);const ia={class:"row justify-between"},ua={class:"q-gutter-xl"},da={class:"q-gutter-xl"},ca={style:{width:"20rem"}},pa={class:"row justify-center q-mt-xl",style:{width:"100%"}},ma=q({__name:"NewPropertySubscription",emits:["addSubscriber","addPropertyType","addStreet"],setup(e,{emit:t}){q({name:"new-property-subscription"});const o=t,n=be("eventBus"),a={width:"35rem"},s={width:"30rem"},i=me();ee.handlePostSubscription(n,{onSuccess:E,onError:K});const m=Yt();let d;const p=P(),C=P([]),T=P([]),{streets:B}=Wt(m),y=Se(new fe),F=x(()=>C.value.map(V=>({label:V.firstName+" "+V.lastName,value:V.id}))),w=x(()=>T.value.map(V=>({label:`${V.name} - ${V.unitPrice}`,value:V.id}))),g=x(()=>{var V;return(V=B==null?void 0:B.value)==null?void 0:V.map(c=>({label:c.name,value:c.id}))});$e(async()=>{y.validate()});async function $(){var V;if(y.validate(),!xe(y)){console.log("the following errors exist",y.errors),await((V=p.value)==null?void 0:V.validate());return}i.loading.show({message:"Submitting ..."}),n.emit(R.NEW_PROPERTY_SUBSCRIPTION,y),d=setTimeout(()=>{i.loading.hide()},Me)}function E(){y.clearValues(),z({loader:i.loading,timer:d})}function K(){z({loader:i.loading,timer:d})}function k(V){o(V)}return pe([()=>y.propertyTypeId,()=>y.propertyUnit],([V,c])=>{if(V&&c){const D=T.value.find(W=>W.id===V);return y.expectedMonthlyCost=String(Number(D==null?void 0:D.unitPrice)*c),y.expectedMonthlyCost}}),se(async()=>{try{B!=null&&B.value||m.fetchServerData({type:"street"}),T.value=await ee.getPropertyTypes(),C.value=await ee.getSubscriberUsers()}catch(V){console.log(V)}}),ie(()=>{n.off(R.NEW_PROPERTY_SUBSCRIPTION)}),(V,c)=>(A(),U(J,null,[l(H,{class:"text-center"},{default:r(()=>[l(De,null,{default:r(()=>[te("New Property Subscription")]),_:1})]),_:1}),l(H,null,{default:r(()=>[l(I(qe),{class:"q-pa-md",style:{height:"100%"},onSubmit:c[15]||(c[15]=ne(()=>{},["prevent"])),ref_key:"propertySubscriptionForm",ref:p},{default:r(()=>[u("div",ia,[u("div",ua,[l(Q,{style:s,label:"Property Name",type:"text",modelValue:y.propertyName,"onUpdate:modelValue":c[0]||(c[0]=D=>y.propertyName=D),filled:"",outlined:"",color:"secondary","label-color":"dark",rules:[()=>V.$validateField(y,"propertyName")]},null,8,["modelValue","rules"]),l(Q,{style:s,label:"Property Unit",type:"text",modelValue:y.propertyUnit,"onUpdate:modelValue":c[1]||(c[1]=D=>y.propertyUnit=D),filled:"",outlined:"",color:"secondary","label-color":"dark",rules:[()=>V.$validateField(y,"propertyUnit")]},null,8,["modelValue","rules"]),l(Q,{style:s,label:"Expected Monthly Cost",type:"text",modelValue:y.expectedMonthlyCost,"onUpdate:modelValue":c[2]||(c[2]=D=>y.expectedMonthlyCost=D),filled:"",outlined:"",color:"secondary","label-color":"dark"},{default:r(()=>[l($t,null,{default:r(()=>[te("Expected Monthly Cost")]),_:1})]),_:1},8,["modelValue"]),l(Q,{style:s,label:"Old Code",type:"text",modelValue:y.oldCode,"onUpdate:modelValue":c[3]||(c[3]=D=>y.oldCode=D),filled:"",outlined:"",color:"secondary","label-color":"dark"},null,8,["modelValue"])]),u("div",da,[u("div",{class:"row",style:a},[l(I(oe),{style:{width:"70%"},label:"Street",filled:"",outlined:"",modelValue:y.streetId,"onUpdate:modelValue":c[6]||(c[6]=D=>y.streetId=D),color:"secondary","label-color":"dark",options:g.value,rules:[()=>V.$validateField(y,"streetId")],clearable:"","emit-value":"","map-options":""},{append:r(()=>[l(I(L),{round:"",flat:"",dense:"",icon:"add",onClick:c[4]||(c[4]=ne(D=>k("addStreet"),["prevent","stop"]))})]),"no-option":r(()=>[l(Ce,null,{default:r(()=>[l(Te,{class:"text-grey"},{default:r(()=>[l(I(L),{flat:"",dense:"",label:"Add Street",onClick:c[5]||(c[5]=D=>k("addStreet"))})]),_:1})]),_:1})]),_:1},8,["modelValue","options","rules"]),l(Q,{style:{width:"30%"},label:"Number",type:"text",modelValue:y.streetNumber,"onUpdate:modelValue":c[7]||(c[7]=D=>y.streetNumber=D),filled:"",outlined:"",color:"secondary","label-color":"dark"},{default:r(()=>[l($t,null,{default:r(()=>[te("Street Number")]),_:1})]),_:1},8,["modelValue"])]),u("div",{style:a},[l(I(oe),{style:{width:"100%"},label:"Property Type",filled:"",outlined:"",modelValue:y.propertyTypeId,"onUpdate:modelValue":c[10]||(c[10]=D=>y.propertyTypeId=D),color:"secondary","label-color":"dark",options:w.value,clearable:"",rules:[()=>V.$validateField(y,"propertyTypeId")],"emit-value":"","map-options":""},{append:r(()=>[l(I(L),{round:"",dense:"",flat:"",icon:"add",onClick:c[8]||(c[8]=ne(D=>k("addPropertyType"),["prevent","stop"]))})]),"no-option":r(()=>[l(Ce,null,{default:r(()=>[l(Te,{class:"text-grey"},{default:r(()=>[l(I(L),{dense:"",flat:"",label:"Add Property Type",onClick:c[9]||(c[9]=D=>k("addPropertyType"))})]),_:1})]),_:1})]),_:1},8,["modelValue","options","rules"])]),u("div",{style:a},[l(I(oe),{style:{width:"100%"},label:"Custodian",filled:"",outlined:"",modelValue:y.propertySubscriberProfileId,"onUpdate:modelValue":c[13]||(c[13]=D=>y.propertySubscriberProfileId=D),color:"secondary","label-color":"dark",clearable:"",options:F.value,rules:[()=>V.$validateField(y,"propertySubscriberProfileId")],"emit-value":"","map-options":""},{append:r(()=>[l(I(L),{round:"",dense:"",flat:"",icon:"add",onClick:c[11]||(c[11]=ne(D=>k("addSubscriber"),["prevent","stop"]))})]),"no-option":r(()=>[l(Ce,null,{default:r(()=>[l(Te,{class:"text-grey"},{default:r(()=>[l(I(L),{dense:"",flat:"",label:"Add Subscriber",onClick:c[12]||(c[12]=D=>k("addSubscriber"))})]),_:1})]),_:1})]),_:1},8,["modelValue","options","rules"])]),u("div",ca,[l(At,{label:"Is Owner",modelValue:y.isOwner,"onUpdate:modelValue":c[14]||(c[14]=D=>y.isOwner=D),color:"primary"},null,8,["modelValue"])])])]),u("div",pa,[l(I(L),{style:{width:"40%"},label:"Submit",rounded:"",color:"primary",type:"submit",onClick:ne($,["prevent"])})])]),_:1},512)]),_:1})],64))}});var fa=Ve({name:"QToggle",props:{...Zl,icon:String,iconColor:String},emits:Xl,setup(e){function t(o,n){const a=x(()=>(o.value===!0?e.checkedIcon:n.value===!0?e.indeterminateIcon:e.uncheckedIcon)||e.icon),s=x(()=>o.value===!0?e.iconColor:null);return()=>[M("div",{class:"q-toggle__track"}),M("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},a.value!==void 0?[M(Re,{name:a.value,color:s.value})]:void 0)]}return Jl("toggle",t)}}),va=Object.defineProperty,ba=Object.getOwnPropertyDescriptor,vt=(e,t,o,n)=>{for(var a=n>1?void 0:n?ba(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&va(t,o,a),a};class nt extends Ae{streetId;propertySuscriptionId;month;year;type;forAllProperties;forPropertiesOnStreet}vt([at()],nt.prototype,"streetId",2);vt([G({message:"Please, select the property subscsription"})],nt.prototype,"propertySuscriptionId",2);vt([G({message:"Please, select the month"})],nt.prototype,"month",2);vt([G({message:"Please, select the year"})],nt.prototype,"year",2);async function ga(e){const t=await Xt.post(we.BILLING,e);if(t.status===201)return t.data;throw new Error("Attempt to generate billing failed",{cause:t.data})}async function ya(e){const t=await Xt.get(we.BILLING,{params:e});if(t.status===200)return t.data;throw new Error("Could not fetch billings")}class Dt{static async handGenerateBilling(t,{onSuccess:o,onError:n}={}){t.on(R.GENERATE_BILLING,async a=>{try{await ga(a),o==null||o(),Pt.create({message:"Process was successful",color:"positive"})}catch(s){n==null||n(),Pt.create({message:s.message,color:"negative",icon:"warning",timeout:5e3})}})}static async getBilling(t){try{return await ya(t)}catch(o){Pt.create({message:o.message,color:"negative",icon:"warning",timeout:5e3})}}static async deleteBilling(t){return await Ee(we.BILLING,"delete",{params:{billingId:t}})}static async updateArrears(t){await Ee(we.UPDATE_ARREARS,"put",{body:t})}}class Xe{static async getBillingAccountArrears(t){try{const o=t.limit,n=t.page;return await Ee(we.BILLING_ACCOUNT_ARREARS,"get",{params:{limit:o,page:n,month:t.month}})}catch{ce({type:"negative"})}}static async handleViewBillingDetails(t,{onSuccess:o,onError:n}={}){t.on(R.VIEW_BILLING_DETAILS,async({streetId:a,billingMonth:s})=>{try{const i=await Ee(we.BILLING_ACCOUNT_DETAILS.replace(":streetId",a),"get",{params:{billingMonth:s}});o==null||o(i)}catch(i){n==null||n(i),ce({type:"negative"})}})}static async handleGetDefaulters(t,{onSuccess:o,onError:n}={}){t.on(R.GET_DEFAULTERS,async({streetId:a})=>{try{const s=await Ee(we.BILLING_ACCOUNT_DEFAULTER.replace(":streetId",a),"get");o==null||o(s)}catch(s){n==null||n(s),ce({type:"negative"})}})}static async getBillingsForPrinting(t,o,n){const a=await Ee(we.BILLING_ACCOUNT_DETAILS.replace(":streetId",t),"get",{params:{billingMonth:o,propertySubscriptionId:n}});return ea().updateBilling({type:"billingDetail",data:a}),a}}const ha={class:"row justify-between q-my-lg"},_a={class:"q-gutter-xl",style:{width:"40%"}},wa={class:"q-gutter-xl",style:{width:"50%"}},Sa={class:"row justify-between q-mt-md",style:{height:"7rem"}},Pa={class:"column"},Ia={class:"column justify-end",style:{height:"100%"}},Ca=q({__name:"GenerateBill",setup(e){q({name:"generate-bill"});const t=Yt(),o=ct[new Date().getMonth()+1],n=be("eventBus"),a=me(),s=yl();let i;Dt.handGenerateBilling(n,{onSuccess:W,onError:re});const m=P("generate"),{streets:d}=Wt(t),p=P(),C=P();P("");const T=x(()=>{var N;return(N=d==null?void 0:d.value)==null?void 0:N.map(f=>({label:f.name,value:f.id}))}),B=P(T.value);function y(N,f){if(N===""){f(()=>{B.value=T.value});return}f(()=>{var b;const h=N.toLowerCase();B.value=(b=T.value)==null?void 0:b.filter(O=>O.label.toLowerCase().indexOf(h)>-1)})}const F=x(()=>m.value==="print"?"Print Bill":"Generate Bill"),w=x(()=>Ol),g=x(()=>Object.values(ct).map(N=>N)),$=x(()=>m.value==="print"?"Print":"Generate"),E=x(()=>{var N;return(N=p.value)==null?void 0:N.map(f=>({label:f.propertySubscriptionName,value:f.propertySubscriptionId}))}),K=P(E.value);function k(N,f){if(N===""){f(()=>{K.value=E.value});return}f(()=>{var b;const h=N.toLowerCase();K.value=(b=E.value)==null?void 0:b.filter(O=>O.label.toLowerCase().indexOf(h)>-1)})}const V=x(()=>c.month+" "+c.year),c=Se(new nt);async function D(){if(a.loading.show({message:"Please, wait ..."}),c.type==="print"){await Xe.getBillingsForPrinting(c.streetId,c.month,c.propertySuscriptionId),s.push(`/print/${V.value}`);return}else n.emit(R.GENERATE_BILLING,c);i=setTimeout(()=>{a.loading.show()},Me)}function W(){c.clearValues(),z({loader:a.loading,timer:i})}function re(){z({loader:a.loading,timer:i})}return pe(m,N=>{N&&(c.type=N)}),pe(()=>c.forAllProperties,N=>{N&&(c.forPropertiesOnStreet=!1)}),pe(()=>c.streetId,async N=>{if(console.log("this is the new val from watch on streetId",N),N){c.propertySuscriptionId="";const f=await ee.getSubscriptions({streetId:N});p.value=f==null?void 0:f.data}}),se(()=>{c.month=o,c.year=String(new Date().getFullYear()),c.type=m.value}),se(async()=>{d!=null&&d.value||await t.fetchServerData({type:"street"})}),se(async()=>{const N=await ee.getSubscriptions();p.value=N==null?void 0:N.data}),ie(()=>{z({loader:a.loading,timer:i})}),(N,f)=>(A(),U(J,null,[l(H,{class:"row justify-between"},{default:r(()=>[u("div",{style:ue({color:`${N.$getColor("primary")}`})},[l(De,{"header-text-size":"h5"},{default:r(()=>[te(Ue(F.value),1)]),_:1})],4),u("div",null,[u("span",{class:Rt([m.value==="print"?"text-primary":""])},"Print Bill",2),l(fa,{"toggle-indeterminate":!1,"toggle-order":"tf","true-value":"generate","false-value":"print",modelValue:m.value,"onUpdate:modelValue":f[0]||(f[0]=h=>m.value=h),"keep-color":""},null,8,["modelValue"]),u("span",{class:Rt([m.value!=="print"?"text-primary":""])},"Generate Bill",2)])]),_:1}),l(H,null,{default:r(()=>[u("form",{class:"q-pa-md",style:{height:"100%"},onSubmit:f[7]||(f[7]=ne(()=>{},["prevent"])),ref_key:"billingModelForm",ref:C},[u("div",ha,[u("div",_a,[l(oe,{label:"Street",modelValue:c.streetId,"onUpdate:modelValue":f[1]||(f[1]=h=>c.streetId=h),filled:"",outlined:"",color:"secondary","label-color":"dark",options:B.value,"emit-value":"","map-options":"","use-input":"",onFilter:y,clearable:""},null,8,["modelValue","options"]),l(oe,{modelValue:c.month,"onUpdate:modelValue":f[2]||(f[2]=h=>c.month=h),label:"Month",type:"text",filled:"",outlined:"",color:"secondary","label-color":"dark",options:g.value},null,8,["modelValue","options"])]),u("div",wa,[l(oe,{modelValue:c.propertySuscriptionId,"onUpdate:modelValue":f[3]||(f[3]=h=>c.propertySuscriptionId=h),label:"Property Subscription Id",type:"text",filled:"",outlined:"",color:"secondary","label-color":"dark",options:K.value,"emit-value":"","map-options":"","use-input":"",onFilter:k,clearable:""},null,8,["modelValue","options"]),l(oe,{modelValue:c.year,"onUpdate:modelValue":f[4]||(f[4]=h=>c.year=h),label:"Year",type:"text",filled:"",outlined:"",options:w.value,color:"secondary","label-color":"dark","emit-value":"","map-options":""},null,8,["modelValue","options"])])]),u("div",Sa,[u("div",Pa,[l(At,{label:`${$.value} for properties on street.`,modelValue:c.forPropertiesOnStreet,"onUpdate:modelValue":f[5]||(f[5]=h=>c.forPropertiesOnStreet=h),disable:c.forAllProperties},null,8,["label","modelValue","disable"]),l(At,{label:`${$.value} all bills.`,modelValue:c.forAllProperties,"onUpdate:modelValue":f[6]||(f[6]=h=>c.forAllProperties=h)},null,8,["label","modelValue"])]),u("div",Ia,[l(L,{rounded:"",color:"primary",onClick:D},{default:r(()=>[te(Ue(m.value==="print"?"Print":"Generate"),1)]),_:1})])])],544)]),_:1})],64))}});var Ta=Object.defineProperty,Va=Object.getOwnPropertyDescriptor,Ne=(e,t,o,n)=>{for(var a=n>1?void 0:n?Va(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&Ta(t,o,a),a};class Pe extends Ae{id;firstName;lastName;email;oldCode;phone;phoneCodeId;password}Ne([G({message:"First name is required"}),mt(2,{message:"First name must be at least 2 characters"}),ft(50,{message:"First name must be less than 50 characters"})],Pe.prototype,"firstName",2);Ne([G({message:"Last name is required"})],Pe.prototype,"lastName",2);Ne([G({message:"Email is required"}),ta({},{message:"Email is invalid"})],Pe.prototype,"email",2);Ne([at()],Pe.prototype,"oldCode",2);Ne([G({message:"Phone number is required"})],Pe.prototype,"phone",2);Ne([G({message:"Phone code is required"})],Pe.prototype,"phoneCodeId",2);Ne([at()],Pe.prototype,"password",2);const ot=q({__name:"ModalPopupClose",setup(e){return q({name:"modal-popup-close"}),(t,o)=>Oe((A(),j(L,{round:"",dense:"",icon:"close"},null,512)),[[la]])}}),Aa={class:"row justify-between q-py-sm"},$a={class:"row justify-between"},Da={class:"q-gutter-xl"},xa={class:"q-gutter-xl"},Na={class:"flex row"},Ba={class:"flex row justify-center"},Oa=q({__name:"AddSubscriber",setup(e){var y,F;q({name:"add-subscriber"});const t=be("eventBus"),o=me(),n=P(),a=P();(y=n.value)==null||y.focus(),(F=a.value)==null||F.focus();const s=P([]),i=P();ee.handlePostSubscriberUser(t,{onSuccess:T,onError:B});let m;const d=Se(new Pe);$e(async()=>{await d.validate()});const p=x(()=>{var w;return(w=s.value)==null?void 0:w.map(g=>({label:g.name,value:g.id}))});function C(){var w;if(!xe(d)){(w=i.value)==null||w.validate();return}t.emit(R.POST_SUBSCRIBER,d),o.loading.show({message:"Submitting ..."}),m=setTimeout(()=>{o.loading.hide()},Me)}function T(){d.clearValues(),z({loader:o.loading,timer:m})}function B(){z({loader:o.loading,timer:m})}return se(async()=>{var w,g;console.log((w=a.value)==null?void 0:w.focus),(g=n.value)==null||g.focus(),s.value=await ee.getPhoneCodes()}),ie(()=>{z({loader:o.loading,timer:m}),t.off(R.POST_SUBSCRIBER)}),(w,g)=>(A(),U(J,null,[l(H,{class:"q-px-md"},{default:r(()=>[u("div",Aa,[l(De,null,{default:r(()=>[te(" Add Subscriber ")]),_:1}),u("div",null,[l(ot)])])]),_:1}),l(H,{class:"q-px-md"},{default:r(()=>[l(I(qe),{onSubmit:g[6]||(g[6]=ne(()=>{},["prevent"])),ref_key:"subscriberForm",ref:i},{default:r(()=>[u("div",$a,[u("div",Da,[l(I(Q),{label:"First Name",filled:"",outlined:"",modelValue:d.firstName,"onUpdate:modelValue":g[0]||(g[0]=$=>d.firstName=$),"lazy-rules":"",rules:[()=>w.$validateField(d,"firstName")],ref_key:"inputRef",ref:a},null,8,["modelValue","rules"]),l(I(Q),{label:"Email",filled:"",outlined:"",modelValue:d.email,"onUpdate:modelValue":g[1]||(g[1]=$=>d.email=$),"lazy-rules":"",rules:[()=>w.$validateField(d,"email")]},null,8,["modelValue","rules"]),l(I(Q),{label:"Old Code",filled:"",outlined:"",modelValue:d.oldCode,"onUpdate:modelValue":g[2]||(g[2]=$=>d.oldCode=$),"lazy-rules":"",rules:[()=>w.$validateField(d,"oldCode")]},null,8,["modelValue","rules"])]),u("div",xa,[l(I(Q),{label:"Last Name",filled:"",outlined:"",modelValue:d.lastName,"onUpdate:modelValue":g[3]||(g[3]=$=>d.lastName=$),"lazy-rules":"",rules:[()=>w.$validateField(d,"lastName")]},null,8,["modelValue","rules"]),u("div",Na,[l(oe,{label:"Country Phone Code",filled:"",outlined:"","label-color":"dark",modelValue:d.phoneCodeId,"onUpdate:modelValue":g[4]||(g[4]=$=>d.phoneCodeId=$),options:p.value,"emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options"]),l(I(Q),{label:"Phone",filled:"",outlined:"",modelValue:d.phone,"onUpdate:modelValue":g[5]||(g[5]=$=>d.phone=$),"lazy-rules":"",rules:[()=>w.$validateField(d,"phone")]},null,8,["modelValue","rules"])])])]),u("div",Ba,[l(L,{style:{width:"40%"},label:"Submit",rounded:"",color:"primary",type:"submit",onClick:C})])]),_:1},512)]),_:1})],64))}});var Ea=Object.defineProperty,La=Object.getOwnPropertyDescriptor,xt=(e,t,o,n)=>{for(var a=n>1?void 0:n?La(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&Ea(t,o,a),a};class bt extends Ae{id;name;lgaId;lgaWardId}xt([G({message:"Street name is required"}),mt(2,{message:"Street name cannot be less than 2 characters"}),ft(50,{message:"Street name cannot be more than 255 characters"})],bt.prototype,"name",2);xt([G({message:"Select an Lga"})],bt.prototype,"lgaId",2);xt([G({message:"Select an Lga ward"})],bt.prototype,"lgaWardId",2);const ka={class:"flex row justify-between"},Ra={class:"q-gutter-xl"},Ua={class:"flex row justify-center q-mt-lg"},qa=q({__name:"AddStreet",emits:["addLga","addLgaWard"],setup(e){q({name:"add-street"});const t=P([]),o=P([]),n=be("eventBus"),a=me(),s=P(),i=P(!1);let m;const d=Se(new bt);ke.handlePostStreet(n,{onSuccess:B,onError:y});const p=x(()=>t.value.map(w=>({label:w.name,value:w.id}))),C=x(()=>o.value.map(w=>({label:w.name,value:w.id})));$e(async()=>{await d.validate()});function T(){var w;if(!i.value){if(!xe(d)){(w=s.value)==null||w.validate();return}i.value=!0,a.loading.show({message:"Submitting ..."}),n.emit(R.POST_STREET,d),m=setTimeout(()=>{a.loading.hide()},Me)}}function B(){d.clearValues(),z({loader:a.loading,timer:m})}function y(){z({loader:a.loading,timer:m})}function F(w){n.emit(w)}return pe(()=>d.lgaId,async w=>{o.value=await ke.getLgaWards({lgaId:w})}),se(async()=>{t.value=await ke.getLgas()}),ie(()=>{z({loader:a.loading,timer:m})}),ie(()=>{n.off(R.POST_STREET)}),(w,g)=>(A(),U(J,null,[l(H,null,{default:r(()=>[u("div",ka,[l(De,null,{default:r(()=>[te("Add Street")]),_:1}),l(ot)])]),_:1}),l(H,null,{default:r(()=>[l(I(qe),{class:"q-px-lg",onSubmit:g[7]||(g[7]=ne(()=>{},["prevent"])),ref_key:"addStreetForm",ref:s},{default:r(()=>[u("div",Ra,[l(Q,{label:"Street Name",type:"text",modelValue:d.name,"onUpdate:modelValue":g[0]||(g[0]=$=>d.name=$),filled:"",outlined:"",color:"secondary","label-color":"dark",rules:[()=>w.$validateField(d,"name")]},null,8,["modelValue","rules"]),l(oe,{label:"Lga",filled:"",outlined:"",color:"secondary","label-color":"dark",options:p.value,rules:[()=>w.$validateField(d,"lgaId")],modelValue:d.lgaId,"onUpdate:modelValue":g[3]||(g[3]=$=>d.lgaId=$),"emit-value":"","map-options":"",clearable:""},{append:r(()=>[l(L,{round:"",flat:"",dense:"",icon:"add",onClick:g[1]||(g[1]=ne($=>F(I(R).TRIGGER_REMOTE_MODAL_LGA),["prevent","stop"]))})]),"no-option":r(()=>[l(Ce,null,{default:r(()=>[l(Te,{class:"text-grey"},{default:r(()=>[l(L,{label:"Add LGA",dense:"",flat:"",onClick:g[2]||(g[2]=$=>F(I(R).TRIGGER_REMOTE_MODAL_LGA))})]),_:1})]),_:1})]),_:1},8,["options","rules","modelValue"]),l(oe,{label:"LGA Ward",filled:"",outlined:"",color:"secondary","label-color":"dark",options:C.value,rules:[()=>w.$validateField(d,"lgaWardId")],modelValue:d.lgaWardId,"onUpdate:modelValue":g[6]||(g[6]=$=>d.lgaWardId=$),"emit-value":"","map-options":"",clearable:""},{append:r(()=>[l(L,{round:"",flat:"",dense:"",icon:"add",onClick:g[4]||(g[4]=ne($=>F(I(R).TRIGGER_REMOTE_MODAL_LGA_WARD),["prevent","stop"]))})]),"no-option":r(()=>[l(Ce,null,{default:r(()=>[l(Te,{class:"text-grey"},{default:r(()=>[l(L,{label:"Add LGA Ward",flat:"",dense:"",onClick:g[5]||(g[5]=$=>F(I(R).TRIGGER_REMOTE_MODAL_LGA_WARD))})]),_:1})]),_:1})]),_:1},8,["options","rules","modelValue"])]),u("div",Ua,[l(L,{style:{width:"40%"},label:"submit",type:"submit",color:"primary",rounded:"",onClick:T})])]),_:1},512)]),_:1})],64))}}),Ma={class:"flex row justify-between"},Ga={class:"q-gutter-md"},Fa={class:"flex row justify-center"},ja=q({__name:"AddPropertyType",setup(e){const t=P(),o=be("eventBus"),n=me();let a;const s=Se(new pl);$e(async()=>{await s.validate()});function i(){var p;xe(s)||(p=t.value)==null||p.validate(),n.loading.show({message:"Submitting ..."}),o.emit(R.POST_PROPERTY_TYPE,s),a=setTimeout(()=>{n.loading.hide()},2e3)}function m(){s.clearValues(),z({loader:n.loading,timer:a})}function d(){z({loader:n.loading,timer:a})}return se(()=>{ee.handlePostPropertyType(o,{onSuccess:m,onError:d})}),ie(()=>{o.off(R.POST_PROPERTY_TYPE)}),(p,C)=>(A(),U(J,null,[l(H,null,{default:r(()=>[u("div",Ma,[l(De,null,{default:r(()=>[te("Add Property Type")]),_:1}),l(ot)])]),_:1}),l(H,null,{default:r(()=>[l(I(qe),{class:"q-px-",onSubmit:C[2]||(C[2]=ne(()=>{},["prevent"]))},{default:r(()=>[u("div",Ga,[l(Q,{label:"Name",type:"text",modelValue:s.name,"onUpdate:modelValue":C[0]||(C[0]=T=>s.name=T),filled:"",outlined:"",color:"secondary","label-color":"dark",rules:[()=>p.$validateField(s,"name")]},null,8,["modelValue","rules"]),l(Q,{label:"Unit Price",type:"number",modelValue:s.unitPrice,"onUpdate:modelValue":C[1]||(C[1]=T=>s.unitPrice=T),filled:"",outlined:"",color:"secondary","label-color":"dark",rules:[()=>p.$validateField(s,"unitPrice")]},null,8,["modelValue","rules"])]),u("div",Fa,[l(L,{style:{width:"40%"},label:"submit",type:"submit",color:"primary",rounded:"",onClick:ne(i,["prevent"])})])]),_:1})]),_:1})],64))}});var Wa=Object.defineProperty,Qa=Object.getOwnPropertyDescriptor,Ha=(e,t,o,n)=>{for(var a=n>1?void 0:n?Qa(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&Wa(t,o,a),a};class Jt extends Ae{id;name}Ha([G({message:"LGA name is required"}),mt(2,{message:"LGA name must be at least 2 characters"}),ft(50,{message:"LGA name must be less than 50 characters"})],Jt.prototype,"name",2);const Ya={class:"flex row justify-between"},za={class:"flex row justify-center q-mt-lg"},Ka=q({__name:"AddLga",setup(e){q({name:"add-lga"});const t=be("eventBus"),o=me();let n;const a=Se(new Jt);ke.handlePostLga(t,{onSuccess:i,onError:m}),$e(async()=>{await a.validate()});function s(){!xe(a)||(o.loading.show({message:"Submitting ..."}),t.emit(R.POST_LGA,a),n=setTimeout(()=>{o.loading.hide()},Me))}function i(){a.clearValues(),z({loader:o.loading,timer:n})}function m(){z({loader:o.loading,timer:n})}return ie(()=>{z({loader:o.loading,timer:n})}),ie(()=>{t.off(R.POST_LGA)}),(d,p)=>(A(),U(J,null,[l(H,null,{default:r(()=>[u("div",Ya,[l(De,null,{default:r(()=>[te("Add L.G.A.")]),_:1}),l(ot)])]),_:1}),l(H,null,{default:r(()=>[u("form",null,[u("div",null,[l(Q,{label:"Name",filled:"",outlined:"","label-color":"dark",modelValue:a.name,"onUpdate:modelValue":p[0]||(p[0]=C=>a.name=C),rules:[()=>d.$validateField(a,"name")]},null,8,["modelValue","rules"])]),u("div",za,[l(L,{style:{width:"40%"},label:"submit",type:"submit",color:"primary",rounded:"",onClick:ne(s,["prevent"])})])])]),_:1})],64))}});var Za=Object.defineProperty,Xa=Object.getOwnPropertyDescriptor,el=(e,t,o,n)=>{for(var a=n>1?void 0:n?Xa(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&Za(t,o,a),a};class Nt extends Ae{id;name;lgaId}el([G({message:"LGA ward name is required"}),mt(2,{message:"LGA ward name must be at least 2 characters"}),ft(50,{message:"LGA ward name must be less than 50 characters"})],Nt.prototype,"name",2);el([G({message:"Select an LGA"})],Nt.prototype,"lgaId",2);const Ja={class:"flex row justify-between"},en={class:"flex row justify-center q-mt-lg"},tn=q({__name:"AddLgaWard",setup(e){q({name:"add-lga-ward"});const t=P([]),o=P(),n=be("eventBus"),a=me();let s;const i=Se(new Nt);ke.handlePostLgaWard(n,{onSuccess:p,onError:C}),$e(async()=>{console.log("this is the lgaWardId: ",i.lgaId),i.validate()});const m=x(()=>t.value.map(T=>({label:T.name,value:T.id})));function d(){if(!xe(i)){i.validate();return}a.loading.show({message:"Submitting ..."}),n.emit(R.POST_LGA_WARD,i),s=setTimeout(()=>{a.loading.hide()},Me)}function p(){i.clearValues(),z({loader:a.loading,timer:s})}function C(){z({loader:a.loading,timer:s})}return se(async()=>{t.value=await ke.getLgas()}),ie(()=>{z({loader:a.loading,timer:s})}),(T,B)=>(A(),U(J,null,[l(H,null,{default:r(()=>[u("div",Ja,[l(De,null,{default:r(()=>[te("Add L.G.A. Ward")]),_:1}),l(ot)])]),_:1}),l(H,null,{default:r(()=>[l(I(qe),{ref_key:"lgaWardForm",ref:o},{default:r(()=>[u("div",null,[l(Q,{label:"Name",filled:"",outlined:"","label-color":"dark",modelValue:i.name,"onUpdate:modelValue":B[0]||(B[0]=y=>i.name=y),rules:[()=>T.$validateField(i,"name")]},null,8,["modelValue","rules"]),l(oe,{label:"Select L.G.A.",filled:"",outlined:"","label-color":"dark",modelValue:i.lgaId,"onUpdate:modelValue":B[1]||(B[1]=y=>i.lgaId=y),options:m.value,rules:[()=>T.$validateField(i,"lgaId")],"emit-value":"","map-options":"",clearable:""},{append:r(()=>[l(L,{flat:"",round:"",dense:"",icon:"add"})]),"no-option":r(()=>[l(Ce,null,{default:r(()=>[l(Te,null,{default:r(()=>[l(L,{label:"Create L.G.A.",flat:"",dense:""})]),_:1})]),_:1})]),_:1},8,["modelValue","options","rules"])]),u("div",en,[l(L,{style:{width:"40%"},label:"submit",type:"submit",color:"primary",rounded:"",onClick:ne(d,["prevent"])})])]),_:1},512)]),_:1})],64))}});var le=(e=>(e.PROPERTIES="Properties",e.BILLINGS="Billings",e))(le||{}),_e=(e=>(e[e.ADD_SUBSCRIBER=0]="ADD_SUBSCRIBER",e[e.ADD_STREET=1]="ADD_STREET",e[e.ADD_PROPERTY_TYPE=2]="ADD_PROPERTY_TYPE",e))(_e||{}),Be=(e=>(e[e.ADD_LGA=0]="ADD_LGA",e[e.ADD_LGA_WARD=1]="ADD_LGA_WARD",e))(Be||{});const ln=["top","right","bottom","left"],tl={type:{type:String,default:"a"},outline:Boolean,push:Boolean,flat:Boolean,unelevated:Boolean,color:String,textColor:String,glossy:Boolean,square:Boolean,padding:String,label:{type:[String,Number],default:""},labelPosition:{type:String,default:"right",validator:e=>ln.includes(e)},externalLabel:Boolean,hideLabel:{type:Boolean},labelClass:[Array,String,Object],labelStyle:[Array,String,Object],disable:Boolean,tabindex:[Number,String]};function ll(e,t){return{formClass:x(()=>`q-fab--form-${e.square===!0?"square":"rounded"}`),stacked:x(()=>e.externalLabel===!1&&["top","bottom"].includes(e.labelPosition)),labelProps:x(()=>{if(e.externalLabel===!0){const o=e.hideLabel===null?t.value===!1:e.hideLabel;return{action:"push",data:{class:[e.labelClass,`q-fab__label q-tooltip--style q-fab__label--external q-fab__label--external-${e.labelPosition}`+(o===!0?" q-fab__label--external-hidden":"")],style:e.labelStyle}}}return{action:["left","top"].includes(e.labelPosition)?"unshift":"push",data:{class:[e.labelClass,`q-fab__label q-fab__label--internal q-fab__label--internal-${e.labelPosition}`+(e.hideLabel===!0?" q-fab__label--internal-hidden":"")],style:e.labelStyle}}})}}const al={start:"self-end",center:"self-center",end:"self-start"},an=Object.keys(al);var nn=Ve({name:"QFabAction",props:{...tl,icon:{type:String,default:""},anchor:{type:String,validator:e=>an.includes(e)},to:[String,Object],replace:Boolean},emits:["click"],setup(e,{slots:t,emit:o}){const n=be(Qt,()=>({showing:{value:!0},onChildClick:hl})),{formClass:a,labelProps:s}=ll(e,n.showing),i=x(()=>{const T=al[e.anchor];return a.value+(T!==void 0?` ${T}`:"")}),m=x(()=>e.disable===!0||n.showing.value!==!0);function d(T){n.onChildClick(T),o("click",T)}function p(){const T=[];return t.icon!==void 0?T.push(t.icon()):e.icon!==""&&T.push(M(Re,{name:e.icon})),(e.label!==""||t.label!==void 0)&&T[s.value.action](M("div",s.value.data,t.label!==void 0?t.label():[e.label])),Ht(t.default,T)}const C=lt();return Object.assign(C.proxy,{click:d}),()=>M(L,{class:i.value,...e,noWrap:!0,stack:e.stacked,icon:void 0,label:void 0,noCaps:!0,fabMini:!0,disable:m.value,onClick:d},p)}});const on=["up","right","down","left"],rn=["left","center","right"];var sn=Ve({name:"QFab",props:{...tl,...zt,icon:String,activeIcon:String,hideIcon:Boolean,hideLabel:{default:null},direction:{type:String,default:"right",validator:e=>on.includes(e)},persistent:Boolean,verticalActionsAlign:{type:String,default:"center",validator:e=>rn.includes(e)}},emits:Kt,setup(e,{slots:t}){const o=P(null),n=P(e.modelValue===!0),a=Nl(),{proxy:{$q:s}}=lt(),{formClass:i,labelProps:m}=ll(e,n),d=x(()=>e.persistent!==!0),{hide:p,toggle:C}=Zt({showing:n,hideOnRouteChange:d}),T=x(()=>({opened:n.value})),B=x(()=>`q-fab z-fab row inline justify-center q-fab--align-${e.verticalActionsAlign} ${i.value}`+(n.value===!0?" q-fab--opened":" q-fab--closed")),y=x(()=>`q-fab__actions flex no-wrap inline q-fab__actions--${e.direction} q-fab__actions--${n.value===!0?"opened":"closed"}`),F=x(()=>{const E={id:a,role:"menu"};return n.value!==!0&&(E["aria-hidden"]="true"),E}),w=x(()=>`q-fab__icon-holder  q-fab__icon-holder--${n.value===!0?"opened":"closed"}`);function g(E,K){const k=t[E],V=`q-fab__${E} absolute-full`;return k===void 0?M(Re,{class:V,name:e[K]||s.iconSet.fab[K]}):M("div",{class:V},k(T.value))}function $(){const E=[];return e.hideIcon!==!0&&E.push(M("div",{class:w.value},[g("icon","icon"),g("active-icon","activeIcon")])),(e.label!==""||t.label!==void 0)&&E[m.value.action](M("div",m.value.data,t.label!==void 0?t.label(T.value):[e.label])),Ht(t.tooltip,E)}return _l(Qt,{showing:n,onChildClick(E){p(E),o.value!==null&&o.value.$el.focus()}}),()=>M("div",{class:B.value},[M(L,{ref:o,class:i.value,...e,noWrap:!0,stack:e.stacked,align:void 0,icon:void 0,label:void 0,noCaps:!0,fab:!0,"aria-expanded":n.value===!0?"true":"false","aria-haspopup":"true","aria-controls":a,onClick:C},$),M("div",{class:y.value,...F.value},tt(t.default))])}});const dt=q({__name:"AdvanceTableMenu",props:{menuItems:{default:()=>[]},padding:{default:"xs"}},emits:["menuItemClickHandler"],setup(e){return q({name:"advance-table-menu"}),(t,o)=>(A(),j(sn,{color:"transparent","text-color":"black",icon:"keyboard_arrow_left",direction:"left",padding:"xs",margin:"xs"},{default:r(()=>[(A(!0),U(J,null,Ie(t.menuItems,n=>(A(),j(nn,{key:n.label,icon:n.icon,color:n.color,"text-color":n.textColor,padding:"xs",onClick:a=>t.$emit("menuItemClickHandler",n)},{default:r(()=>[l($t,null,{default:r(()=>[te(Ue(n.label),1)]),_:2},1024)]),_:2},1032,["icon","color","text-color","onClick"]))),128))]),_:1}))}});function et(e,t=new WeakMap){if(Object(e)!==e)return e;if(t.has(e))return t.get(e);const o=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e instanceof Set?new Set:e instanceof Map?new Map:typeof e.constructor!="function"?Object.create(null):e.prototype!==void 0&&typeof e.prototype.constructor=="function"?e:new e.constructor;if(typeof e.constructor=="function"&&typeof e.valueOf=="function"){const n=e.valueOf();if(Object(n)!==n){const a=new e.constructor(n);return t.set(e,a),a}}return t.set(e,o),e instanceof Set?e.forEach(n=>{o.add(et(n,t))}):e instanceof Map&&e.forEach((n,a)=>{o.set(a,et(n,t))}),Object.assign(o,...Object.keys(e).map(n=>({[n]:et(e[n],t)})))}var Ct=Ve({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(e,{slots:t,emit:o}){const{proxy:n}=lt(),{$q:a}=n,s=P(null),i=P(""),m=P("");let d=!1;const p=x(()=>Pl({initialValue:i.value,validate:e.validate,set:C,cancel:T,updatePosition:B},"value",()=>m.value,k=>{m.value=k}));function C(){e.validate(m.value)!==!1&&(y()===!0&&(o("save",m.value,i.value),o("update:modelValue",m.value)),F())}function T(){y()===!0&&o("cancel",m.value,i.value),F()}function B(){wl(()=>{s.value.updatePosition()})}function y(){return Sl(m.value,i.value)===!1}function F(){d=!0,s.value.hide()}function w(){d=!1,i.value=et(e.modelValue),m.value=et(e.modelValue),o("beforeShow")}function g(){o("show")}function $(){d===!1&&y()===!0&&(e.autoSave===!0&&e.validate(m.value)===!0?(o("save",m.value,i.value),o("update:modelValue",m.value)):o("cancel",m.value,i.value)),o("beforeHide")}function E(){o("hide")}function K(){const k=t.default!==void 0?[].concat(t.default(p.value)):[];return e.title&&k.unshift(M("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},e.title)),e.buttons===!0&&k.push(M("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[M(L,{flat:!0,color:e.color,label:e.labelCancel||a.lang.label.cancel,onClick:T}),M(L,{flat:!0,color:e.color,label:e.labelSet||a.lang.label.set,onClick:C})])),k}return Object.assign(n,{set:C,cancel:T,show(k){s.value!==null&&s.value.show(k)},hide(k){s.value!==null&&s.value.hide(k)},updatePosition:B}),()=>{if(e.disable!==!0)return M(zl,{ref:s,class:"q-popup-edit",cover:e.cover,onBeforeShow:w,onShow:g,onBeforeHide:$,onHide:E,onEscapeKey:T},K)}}});async function nl({process:e,onError:t,loader:o,useNotifer:n=!0,notifierType:a="positive",notifierMessage:s,loaderMessage:i="Please, wait!",showErrorNotifier:m=!0}){o&&o.show({message:i});try{await e(),n&&ce({type:a,...s?{message:s}:{}})}catch(d){const p=d;t==null||t(),m&&ce({type:"negative",...p.message?{message:p.message}:{}})}finally{o!=null&&o.isActive&&o.hide()}}var un=Object.defineProperty,dn=Object.getOwnPropertyDescriptor,Bt=(e,t,o,n)=>{for(var a=n>1?void 0:n?dn(t,o):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,o,a):i(a))||a);return n&&a&&un(t,o,a),a};class gt extends Ae{amount;propertySubscriptionId;reason}Bt([G(),Ll({},{message:"Please, enter a valid amount in numbers."})],gt.prototype,"amount",2);Bt([G({message:"Property Subscription Reference not defined."})],gt.prototype,"propertySubscriptionId",2);Bt([G()],gt.prototype,"reason",2);const cn=u("div",{class:"text-h4"},"Edit Arrears",-1),pn={class:"q-pa-md"},mn=q({__name:"EditArrears",props:{amount:{},propertySubscriptionId:{}},emits:["updateAmount"],setup(e,{emit:t}){q({name:"edit-arrears"});const o=e,n=t,a=Se(new gt),s=me();$e(()=>{a.validate()});async function i(){nl({loader:s.loading,process:async()=>{if(a.validate(),!xe(a))throw console.log("Edit Areas model is invalid."),new Error("Edit Areas model is invalid.");await Dt.updateArrears({arrears:a.amount,propertySubscriptionId:a.propertySubscriptionId,reason:a.reason})},onError:()=>{console.log("Error saving arrears!")},loaderMessage:"Saving ...",notifierType:"positive",notifierMessage:"Process successful",showErrorNotifier:!0})}function m(d){n("updateAmount",d),a.amount=d}return se(()=>{a.amount=o.amount,a.propertySubscriptionId=o.propertySubscriptionId}),(d,p)=>(A(),U("div",null,[l(pt,null,{default:r(()=>[l(H,null,{default:r(()=>[cn]),_:1}),l(H,null,{default:r(()=>[u("div",pn,[l(qe,null,{default:r(()=>[l(Q,{"model-value":a.amount,"onUpdate:modelValue":m,label:"Amount",rules:[()=>d.$validateField(a,"amount")]},null,8,["model-value","rules"]),l(Q,{modelValue:a.reason,"onUpdate:modelValue":p[0]||(p[0]=C=>a.reason=C),label:"Reason",rules:[()=>d.$validateField(a,"reason")]},null,8,["modelValue","rules"]),l(L,{label:"Save",onClick:i})]),_:1})])]),_:1})]),_:1})]))}}),Qe=q({__name:"BorderedCard",props:{bgColor:{default:"secondary"},borderColor:{default:"primary"},borderStyle:{default:"solid"},borderWidth:{default:"0.1rem"},height:{default:"100%"}},setup(e){return q({name:"bordered-card"}),(t,o)=>(A(),j(pt,{style:ue({borderColor:`${t.$getColor(t.borderColor)}`,borderStyle:`${t.borderStyle}`,borderWidth:`${t.borderWidth}`,backgroundColor:`${t.$getColor(t.bgColor)}`,height:t.height})},{default:r(()=>[l(H,null,{default:r(()=>[Il(t.$slots,"default")]),_:3})]),_:3},8,["style"]))}}),ol=6e4,rl=36e5,Ft=Symbol.for("constructDateFrom");function sl(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Ft in e?e[Ft](t):e instanceof Date?new e.constructor(t):new Date(t)}function jt(e,t){return sl(t||e,e)}function Tt(e,t){const o=()=>sl(t==null?void 0:t.in,NaN),n=(t==null?void 0:t.additionalDigits)??2,a=gn(e);let s;if(a.date){const p=yn(a.date,n);s=hn(p.restDateString,p.year)}if(!s||isNaN(+s))return o();const i=+s;let m=0,d;if(a.time&&(m=_n(a.time),isNaN(m)))return o();if(a.timezone){if(d=wn(a.timezone),isNaN(d))return o()}else{const p=new Date(i+m),C=jt(0,t==null?void 0:t.in);return C.setFullYear(p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate()),C.setHours(p.getUTCHours(),p.getUTCMinutes(),p.getUTCSeconds(),p.getUTCMilliseconds()),C}return jt(i+m+d,t==null?void 0:t.in)}const it={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},fn=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,vn=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,bn=/^([+-])(\d{2})(?::?(\d{2}))?$/;function gn(e){const t={},o=e.split(it.dateTimeDelimiter);let n;if(o.length>2)return t;if(/:/.test(o[0])?n=o[0]:(t.date=o[0],n=o[1],it.timeZoneDelimiter.test(t.date)&&(t.date=e.split(it.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const a=it.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function yn(e,t){const o=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(o);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?a:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function hn(e,t){if(t===null)return new Date(NaN);const o=e.match(fn);if(!o)return new Date(NaN);const n=!!o[4],a=He(o[1]),s=He(o[2])-1,i=He(o[3]),m=He(o[4]),d=He(o[5])-1;if(n)return Tn(t,m,d)?Sn(t,m,d):new Date(NaN);{const p=new Date(0);return!In(t,s,i)||!Cn(t,a)?new Date(NaN):(p.setUTCFullYear(t,s,Math.max(a,i)),p)}}function He(e){return e?parseInt(e):1}function _n(e){const t=e.match(vn);if(!t)return NaN;const o=Vt(t[1]),n=Vt(t[2]),a=Vt(t[3]);return Vn(o,n,a)?o*rl+n*ol+a*1e3:NaN}function Vt(e){return e&&parseFloat(e.replace(",","."))||0}function wn(e){if(e==="Z")return 0;const t=e.match(bn);if(!t)return 0;const o=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return An(n,a)?o*(n*rl+a*ol):NaN}function Sn(e,t,o){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,s=(t-1)*7+o+1-a;return n.setUTCDate(n.getUTCDate()+s),n}const Pn=[31,null,31,30,31,30,31,31,30,31,30,31];function il(e){return e%400===0||e%4===0&&e%100!==0}function In(e,t,o){return t>=0&&t<=11&&o>=1&&o<=(Pn[t]||(il(e)?29:28))}function Cn(e,t){return t>=1&&t<=(il(e)?366:365)}function Tn(e,t,o){return t>=1&&t<=53&&o>=0&&o<=6}function Vn(e,t,o){return e===24?t===0&&o===0:o>=0&&o<60&&t>=0&&t<60&&e>=0&&e<25}function An(e,t){return t>=0&&t<=59}const $n={class:"flex row justify-between q-mb-sm",style:{width:"100%",height:"12rem"}},Dn={style:{width:"49.5%"}},xn=u("div",{class:"text-center text-bolder text-h6"},[u("span",null,"Property")],-1),Nn={class:"q-my-lg"},Bn=u("span",null,"Id",-1),On={class:"q-my-lg"},En=u("span",null,"Name",-1),Ln=u("span",null,"Phone",-1),kn={style:{width:"49.5%"}},Rn=u("div",{class:"text-center text-bolder text-h6"},[u("span",null,"Transaction")],-1),Un=u("span",null,"Arrears",-1),qn=u("span",null,"Last Payment",-1),Mn=u("span",null,"Date of Payment",-1),Gn={style:{width:"100%",height:"8rem"}},Fn=u("div",null,[u("p",null,[u("span",null,"Street")])],-1),jn={class:"flex row justify-evenly"},Wn=u("span",null,"Number",-1),Qn=u("span",null,"Name",-1),Hn={style:{width:"100%",height:"8rem"}},Yn=u("div",null,[u("p",null,[u("span",null,"Custodian")])],-1),zn={class:"flex row justify-evenly q-mt-md"},Kn=u("span",null,"Name",-1),Zn=u("span",null,"Email",-1),Xn=u("span",null,"Phone",-1),Jn={style:{width:"100%",height:"auto"}},eo={class:"flex row text-bolder text-h6 flex items-center"},to=u("div",{class:"flex row justify-end",style:{width:"50%"}},[u("span",null,"Billing Details")],-1),lo={class:"flex row justify-end q-gutter-sm q-mb-sm",style:{width:"50%"}},ao={key:0},no={key:1},oo={key:2},ro=u("div",null,null,-1),so=q({__name:"ViewPropertyDetails",props:{dialogWidth:{default:30},propertySubscriptionId:{}},setup(e){const t=e;q({name:"view-property-details",components:{DialogCard:Je}});const o=me(),n=[{label:"Remove Row",icon:"remove",textColor:"black"}],a=[{field:"propertyTypeId",label:"Property Type Id",name:"propertyTypeId"},{field:"propertyType",label:"Property Type",name:"propertyType"},{field:"propertyUnit",label:"Property Units",name:"propertyUnit"},{field:"unitPrice",label:"Unit Price",name:"unitPrice"}],s=["propertyType","propertyUnit","unitPrice"],i=P([{propertyTypeId:"1",propertyType:"House",propertyUnit:"5",unitPrice:"N5000"}]),m=P([]),d=P(!1),p=P({}),C=P(-1),T=P(!1),B=P(""),y=P(!1);P(!1),P(!1);const F=x(()=>m.value.map(f=>({label:`${f.name} - ${f.unitPrice}`,value:f.id})));async function w(f){await nl({loader:o.loading,process:async()=>{await ee.updatePropertyName({propertySubscriptionName:f,propertySubscriptionId:t.propertySubscriptionId})},loaderMessage:"Updating property name..."}),await re()}x(()=>{if(p.value.billingAccount){const f=Number(I(p.value).billingAccount.totalBillings)-Number(I(p.value).billingAccount.totalPayments);return"N"+f}else return"N0"});const g=x(()=>{const f=p.value.payments;if(f&&f.length>0){const h=I(p.value).payments.sort((b,O)=>Tt(O.createdAt).getTime()-Tt(b.createdAt).getTime())[0];return{createdAt:Tt(h.createdAt).toDateString(),amount:h.amount}}else return{createdAt:"--/--/--",amount:"N0"}}),$=x(()=>{var b;let f={email:"",name:"",phone:""};const h=p.value.entitySubscriberProfile;return h&&(f={email:h.email,name:h.firstName+h.lastName,phone:(((b=h.phoneCode)==null?void 0:b.name)||"")+f.phone||""}),f}),E=x(()=>p.value.streetNumber?{num:I(p.value).streetNumber,name:I(p.value).street.name}:{});function K(f,h){console.log("the updated value is: -->",f);const b=m.value.find(O=>O.id===f.value);h.value=(b==null?void 0:b.name)||"",i.value[C.value].propertyTypeId=(b==null?void 0:b.id)||"",i.value[C.value].unitPrice=String((b==null?void 0:b.unitPrice)||"")}async function k(){m.value=await ee.getPropertyTypes()}async function V(){T.value=!0;try{await ee.savePropertyUnits({propertySubscriptionId:p.value.id,propertySubscriptionUnits:i.value}),ce({type:"positive"})}catch{ce({type:"negative"})}T.value=!1,d.value=!1}function c(){i.value.push({propertyTypeId:"",propertyType:"",propertyUnit:"",unitPrice:""})}function D(f){i.value.splice(f,1)}function W(f){C.value=f}async function re(){p.value=await ee.getPropertySubscriptionDetails(t.propertySubscriptionId)}function N(){y.value=!y.value}return pe(p,f=>{if(f){const h=Number(I(p.value).billingAccount.totalBillings)-Number(I(p.value).billingAccount.totalPayments);B.value=""+h}}),pe(p,f=>{f&&(i.value=p.value.propertySubscriptionUnits.map(h=>({propertyTypeId:h.entitySubscriberProperty.propertyType.id,propertyType:h.entitySubscriberProperty.propertyType.name,propertyUnit:h.propertyUnits,unitPrice:h.entitySubscriberProperty.propertyType.unitPrice})))}),se(async()=>{await re()}),(f,h)=>(A(),j(Je,{height:"auto",width:`${f.dialogWidth}rem`},{default:r(()=>[l(H,{class:"q-pa-lg flex column q-gutter-sm moderate-modal-font"},{default:r(()=>[u("div",$n,[u("div",Dn,[l(Qe,null,{default:r(()=>[xn,u("div",null,[u("p",Nn,[Bn,l(ae,{class:"q-ml-sm q-pa-sm q-px-sm",label:p.value.id,rounded:""},null,8,["label"])]),u("p",On,[En,l(ae,{class:"q-ml-sm q-pa-sm q-px-sm",label:p.value.propertySubscriptionName,rounded:""},{default:r(()=>[l(Ct,{modelValue:p.value.propertySubscriptionName,"onUpdate:modelValue":h[0]||(h[0]=b=>p.value.propertySubscriptionName=b),title:"Edit Property Name","auto-save":""},{default:r(b=>[l(Q,{modelValue:b.value,"onUpdate:modelValue":O=>b.value=O,dense:"",autofocus:"",counter:"",onKeyup:It(O=>w(b.value),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"]),l(Re,{name:"edit",class:"q-ml-sm cursor-pointer text-subtitle1"})]),_:1},8,["label"])]),u("p",null,[Ln,l(ae,{class:"q-ml-sm q-pa-sm q-px-sm",label:$.value.phone,rounded:""},{default:r(()=>[l(Ct,{modelValue:$.value.phone,"onUpdate:modelValue":h[1]||(h[1]=b=>$.value.phone=b),title:"Edit Phone Number","auto-save":""},{default:r(b=>[l(Q,{modelValue:b.value,"onUpdate:modelValue":O=>b.value=O,dense:"",autofocus:"",counter:"",onKeyup:It(O=>f.updatePhone(b.value),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"]),l(Re,{name:"edit",class:"q-ml-sm cursor-pointer text-subtitle1"})]),_:1},8,["label"])])])]),_:1})]),u("div",kn,[l(Qe,null,{default:r(()=>[Rn,u("div",null,[u("p",null,[Un,l(L,{flat:"",padding:"0",onClick:N},{default:r(()=>[l(Bl,{class:"q-ml-sm q-pa-sm q-px-sm",label:"N"+B.value,rounded:"",color:"primary","text-color":"white","icon-right":"edit"},null,8,["label"])]),_:1}),l(Ke,{modelValue:y.value,"onUpdate:modelValue":h[3]||(h[3]=b=>y.value=b)},{default:r(()=>[u("div",null,[l(mn,{amount:B.value,"property-subscription-id":f.propertySubscriptionId,onUpdateAmount:h[2]||(h[2]=b=>B.value=b)},null,8,["amount","property-subscription-id"])])]),_:1},8,["modelValue"])]),u("p",null,[qn,l(ae,{class:"q-ml-sm q-pa-sm q-px-sm",label:g.value.amount,rounded:""},null,8,["label"])]),u("p",null,[Mn,l(ae,{class:"q-ml-sm q-pa-sm q-px-sm",label:g.value.createdAt,rounded:""},null,8,["label"])])])]),_:1})])]),u("div",Gn,[l(Qe,null,{default:r(()=>[Fn,u("div",jn,[u("p",null,[Wn,l(ae,{class:"q-ml-sm q-pa-sm q-px-sm",label:E.value.num,rounded:""},null,8,["label"])]),u("p",null,[Qn,l(ae,{class:"q-ml-sm q-pa-sm q-px-sm",label:E.value.name,rounded:""},null,8,["label"])])])]),_:1})]),u("div",Hn,[l(Qe,null,{default:r(()=>[Yn,u("div",zn,[u("p",null,[Kn,l(ae,{class:"q-ml-sm q-pa-sm q-px-sm",label:$.value.name,rounded:""},null,8,["label"])]),u("p",null,[Zn,l(ae,{class:"q-ml-sm q-pa-sm q-px-sm",label:$.value.email,rounded:""},null,8,["label"])]),u("p",null,[Xn,l(ae,{class:"q-ml-sm q-pa-sm q-px-sm",label:$.value.phone,rounded:""},null,8,["label"])])])]),_:1})]),u("div",Jn,[l(Qe,null,{default:r(()=>[u("div",eo,[to,u("div",lo,[d.value?de("",!0):(A(),U("span",ao,[l(L,{icon:"edit",round:"",onClick:h[4]||(h[4]=b=>d.value=!0)})])),d.value?(A(),U("span",no,[l(L,{icon:"add",round:"",onClick:c})])):de("",!0),d.value?(A(),U("span",oo,[l(L,{icon:"save",round:"",onClick:V})])):de("",!0)])]),u("div",null,[l(ze,{bordered:"",column:a,rows:i.value,"visible-columns":s,"table-header-class":"text-bolder","table-header-style":{backgroundColor:`${f.$getColor("secondary")}`},loading:T.value,"sort-method":b=>b,onRowClick:h[6]||(h[6]=b=>console.log("row with the following data was clicked: ",b))},{header:r(b=>[l(Le,{props:b},{default:r(()=>[(A(!0),U(J,null,Ie(b.cols,O=>(A(),j(El,{key:O.name,props:b,style:{textAlign:"left"}},{default:r(()=>[te(Ue(O.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:r(b=>[l(Le,{props:b,onMouseenter:O=>W(b.rowIndex)},{default:r(()=>[(A(!0),U(J,null,Ie(b.cols,(O,ye)=>(A(),j(Ze,{key:O.name,class:"text-left",style:{postion:"relative"}},{default:r(()=>[O.name==="propertyType"?(A(),U(J,{key:0},[te(Ue(b.row[O.name])+" ",1),l(Ct,{modelValue:b.row[O.name],"onUpdate:modelValue":Z=>b.row[O.name]=Z,title:"Edit the Property Type","auto-save":""},{default:r(Z=>[l(oe,{filled:"","model-value":Z.value,options:F.value,"use-input":"","input-debounce":"0",style:{width:"250px"},disable:!d.value,onKeyup:It(Z.set,["enter"]),onPopupShow:k,"onUpdate:modelValue":Ge=>K(Ge,Z)},{"no-option":r(()=>[l(Ce,null,{default:r(()=>[l(Te,{class:"text-grey"},{default:r(()=>[te(" No results ")]),_:1})]),_:1})]),_:2},1032,["model-value","options","disable","onKeyup","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue"])],64)):(A(),U(J,{key:1},[l(Q,{modelValue:b.row[O.name],"onUpdate:modelValue":Z=>b.row[O.name]=Z,type:"text",dense:"",borderless:"",disable:!d.value},null,8,["modelValue","onUpdate:modelValue","disable"]),ye===b.cols.length-1?Oe((A(),U("span",{key:0,style:ue({position:"absolute",top:C.value===b.rowIndex?"0.5rem":"0",right:C.value===b.rowIndex?"0.5rem":"0",zIndex:C.value===b.rowIndex?"1":"0"})},[l(dt,{"menu-items":n,onMenuItemClickHandler:h[5]||(h[5]=()=>D(C.value))})],4)),[[Ye,C.value===b.rowIndex]]):de("",!0)],64))]),_:2},1024))),128))]),_:2},1032,["props","onMouseenter"])]),_:1},8,["rows","table-header-style","loading","sort-method"])]),ro]),_:1})])]),_:1})]),_:1},8,["width"]))}});const io={class:"row justify-between items-center"},uo={class:"q-mt-xl"},co={class:"q-mt-lg",style:{height:"70vh"}},po={class:"q-mb-lg",style:{width:"20rem"}},ut=80,qo=q({__name:"PropertyBillingPage",setup(e){const t=me(),o=Rl("light-page")||"#ffffff",n=be("eventBus"),a=[{label:"View Details",icon:"visibility",textColor:"black"},{label:"Get Defaulters",icon:"paid",textColor:"black"}],s=[{label:"View Details",icon:"visibility",textColor:"black"},{label:"View Payments",icon:"paid",textColor:"black"}],i=[{label:"Delete",icon:"remove",textColor:"black"}];ee.handlePaginateSubscription(n,{onSuccess:_t,onError:wt});const m=ct[new Date().getMonth()+1],d=[{field:"propertySubscriptionId",label:"Property Subscription Id",name:"propertySubscriptionId",align:"left"},{field:"propertyName",label:"Property Name",name:"propertyName",align:"left"},{field:"oldCode",label:"Old Code",name:"oldCode",align:"left"},{field:"streetNumber",label:"Street Number",name:"streetNumber",align:"left"},{field:"streetName",label:"Street Name",name:"streetName",align:"left"},{field:"arrears",label:"Arrears",name:"arrears",align:"left"}],p=[{field:"streetId",name:"streetId",label:"streetId",align:"center"},{field:"streetName",label:"Street Name",name:"streetName",align:"center"},{field:"arrears",label:"Arrears",name:"arrears",align:"center"},{field:"totalBilling",label:"Total Billing",name:"totalBilling",align:"center"},{field:"actions",label:"Actions",name:"actions",align:"center"}],C=[{field:"streetName",label:"Street Name",name:"streetName",align:"center"},{field:"propertyName",label:"Property Name",name:"propertyName",align:"center"},{field:"currentBilling",label:"Current Billing",name:"currentBilling",align:"center"},{field:"currentBillingId",label:"Current Billing",name:"currentBillingId",align:"center"},{field:"arrears",label:"Arrears",name:"arrears",align:"center"}],T=[...C,{field:"totalBilling",label:"Total Billing",name:"totalBilling",align:"center"},{field:"lastPayment",label:"Last Payment",name:"lastPayment",align:"center"}],B=["streetName","arrears","totalBilling"],y=C.filter(S=>S.name!=="currentBillingId").map(S=>S.field),F=[...y,"totalBilling","lastPayment"],w={billing:"billing",billingDetails:"billingDetails",billingDefaulters:"defaulters"};Xe.handleViewBillingDetails(n,{onSuccess:ul}),Xe.handleGetDefaulters(n,{onSuccess:dl});const g=P(le.PROPERTIES),$=P(!1),E=P(m),K=P(!1),k=P(!1),V=P(_e.ADD_SUBSCRIBER),c=P(Be.ADD_LGA),D=P(),W=P(-1);let re=P([]);const N=P("billing"),f=P([]),h=P({page:1,rowsPerPage:3,rowsNumber:10}),b=P(!0),O=P(""),ye=P(!1);let Z=P();const Ge=x(()=>Object.values(ct).map(S=>S)),yt=x(()=>({[le.PROPERTIES]:"Add New Property",[le.BILLINGS]:"Generate / Print Billing"})[g.value]),ht=x(()=>{var S;return(S=D.value)==null?void 0:S.map(v=>({propertySubscriptionId:v.propertySubscriptionId,propertyName:v.propertySubscriptionName,oldCode:v.oldCode,streetNumber:v.streetNumber,streetName:v.streetName,arrears:v.arrears}))}),rt=x(()=>{var S;return(S=re.value)==null?void 0:S.map(v=>({streetName:v.streetName,arrears:v.arrears,streetId:v.streetId,totalBilling:v.totalBilling}))});function _t(S){ce({type:"positive"}),D.value=S==null?void 0:S.data,h.value=S==null?void 0:S.pagination}function wt(){ce({type:"negative",message:"Could not load more data!"})}async function X(S){b.value=!0;const v=await ee.getSubscriptionByPages(S);D.value=v==null?void 0:v.data,h.value=v==null?void 0:v.pagination,b.value=!1}async function Fe(S,v){v==="View Details"?(Z.value=S,ye.value=!0):alert("This feature is under development.")}async function ve(S,v){try{S==="Delete"&&(t.loading.show({message:"Deleting ..."}),await Dt.deleteBilling(v),ce({type:"positive",message:"Process successful!"}),t.loading.hide(),window.location.reload())}catch{ce({type:"negative"}),t.loading.hide()}}async function st(S,v){v&&(console.log("payload",v),S==="View Details"?n.emit(R.VIEW_BILLING_DETAILS,{streetId:v,billingMonth:E.value}):S==="Get Defaulters"&&n.emit(R.GET_DEFAULTERS,{streetId:v}))}function ul(S){N.value=w.billingDetails,f.value=S}function dl(S){N.value=w.billingDefaulters,f.value=S}function he(S){W.value=S}function cl(){$.value=!$.value}function St(S){K.value=!0,V.value=S}return n.on(R.TRIGGER_REMOTE_MODAL_LGA,()=>{c.value=Be.ADD_LGA,k.value=!0}),n.on(R.TRIGGER_REMOTE_MODAL_LGA_WARD,()=>{c.value=Be.ADD_LGA_WARD,k.value=!0}),pe(O,async S=>{if(S){b.value=!0;const v=await ee.getSubscriptionByPages({pagination:h.value,filter:O.value});D.value=v==null?void 0:v.data,h.value=v==null?void 0:v.pagination,b.value=!1}}),Cl(async()=>{g.value===le.PROPERTIES&&(re.value=await Xe.getBillingAccountArrears({page:1,limit:200}))}),pe(E,async()=>{g.value===le.BILLINGS&&(re.value=await Xe.getBillingAccountArrears({page:1,limit:200,month:E.value}))}),Tl(()=>{t.loading.show({message:"Please, wait ..."})}),se(()=>{t.loading.hide()}),se(async()=>{const S=await ee.getSubscriptions();D.value=S==null?void 0:S.data,h.value=S==null?void 0:S.pagination,b.value=!1}),ie(async()=>{n.off(R.VIEW_BILLING_DETAILS),n.off(R.GET_DEFAULTERS),n.off(R.PAGINATE_SUBSCRIPTION_TABLE)}),(S,v)=>(A(),j(kl,null,{default:r(()=>[u("div",{style:ue({backgroundColor:I(o),height:"100vh",padding:"0 1rem",width:"100%"})},[u("div",io,[u("div",uo,[l(ml,{modelValue:g.value,"onUpdate:modelValue":v[0]||(v[0]=_=>g.value=_),dense:"","active-color":"dark","active-bg-color":"secondary"},{default:r(()=>[l(Ot,{name:I(le).PROPERTIES,icon:"house",label:I(le).PROPERTIES,style:{width:"15rem"}},null,8,["name","label"]),l(Ot,{name:I(le).BILLINGS,icon:"receipt",label:I(le).BILLINGS,style:{width:"15rem"}},null,8,["name","label"])]),_:1},8,["modelValue"])]),u("div",null,[l(L,{color:"primary",rounded:"","no-caps":"",onClick:cl},{default:r(()=>[te(Ue(yt.value),1)]),_:1})])]),u("div",co,[l(fl,{modelValue:g.value,"onUpdate:modelValue":v[9]||(v[9]=_=>g.value=_),style:{"background-color":"inherit",height:"100%"}},{default:r(()=>[l(Et,{name:I(le).PROPERTIES},{default:r(()=>[u("div",null,[l(pt,{rounded:"",class:"bg-accent"},{default:r(()=>[l(H,null,{default:r(()=>[l(ze,{class:"header-sticky",rows:ht.value,bordered:"",columns:d,"table-header-style":{backgroundColor:`${S.$getColor("secondary")}`},onRequest:X,pagination:h.value,"onUpdate:pagination":v[3]||(v[3]=_=>h.value=_),loading:b.value,filter:O.value},{"top-right":r(()=>[l(Q,{borderless:"",dense:"",debounce:"300",modelValue:O.value,"onUpdate:modelValue":v[1]||(v[1]=_=>O.value=_),placeholder:"Search"},{append:r(()=>[l(Re,{name:"search"})]),_:1},8,["modelValue"])]),body:r(_=>[l(Le,{props:_,onMouseenter:Y=>he(_.rowIndex),onMouseleave:v[2]||(v[2]=Y=>he(-1))},{default:r(()=>[(A(!0),U(J,null,Ie(_.cols,(Y,je)=>(A(),j(Ze,{key:Y.name},{default:r(()=>[l(ae,{label:Y.value,class:"text-bold",style:ue({backgroundColor:"transparent",color:`${S.$getColor("dark")}`})},null,8,["label","style"]),je===_.cols.length-1?Oe((A(),U("span",{key:0,style:ue({position:"absolute",top:W.value===_.rowIndex?"0.5rem":"0",right:W.value===_.rowIndex?"0.5rem":"0",zIndex:W.value===_.rowIndex?"1":"0"})},[l(dt,{"menu-items":s,onMenuItemClickHandler:We=>Fe(_.row.propertySubscriptionId,We.label)},null,8,["onMenuItemClickHandler"])],4)),[[Ye,W.value===_.rowIndex]]):de("",!0)]),_:2},1024))),128))]),_:2},1032,["props","onMouseenter"])]),_:1},8,["rows","table-header-style","pagination","loading","filter"])]),_:1})]),_:1})])]),_:1},8,["name"]),l(Et,{name:I(le).BILLINGS},{default:r(()=>[u("div",po,[l(oe,{style:{width:"100%"},modelValue:E.value,"onUpdate:modelValue":v[4]||(v[4]=_=>E.value=_),label:"Month",filled:"",outlined:"","label-color":"dark",options:Ge.value,clearable:"","map-options":"","emit-value":""},null,8,["modelValue","options"])]),u("div",null,[l(pt,{rounded:"",class:"bg-accent"},{default:r(()=>[Oe(l(H,null,{default:r(()=>[l(L,{icon:"arrow_back",flat:"",onClick:v[5]||(v[5]=_=>N.value=w.billing)})]),_:1},512),[[Ye,N.value!==w.billing]]),l(H,null,{default:r(()=>[N.value===w.billing?(A(),j(ze,{key:0,bordered:"",columns:p,rows:rt.value,"visible-columns":B,"table-header-class":"text-bolder","table-header-style":{backgroundColor:`${S.$getColor("secondary")}`}},{body:r(_=>[l(Le,{props:_,onMouseenter:Y=>he(_.rowIndex),onMouseleave:v[6]||(v[6]=Y=>he(-1))},{default:r(()=>[(A(!0),U(J,null,Ie(_.cols,(Y,je)=>(A(),j(Ze,{key:Y.name,class:"text-center",style:{postion:"relative"}},{default:r(()=>[l(ae,{label:Y.value,class:"text-bold",style:ue({backgroundColor:"transparent",color:`${S.$getColor("dark")}`})},null,8,["label","style"]),je===_.cols.length-1?Oe((A(),U("span",{key:0,style:ue({position:"absolute",top:W.value===_.rowIndex?"0.5rem":"0",right:W.value===_.rowIndex?"0.5rem":"0",zIndex:W.value===_.rowIndex?"1":"0"})},[l(dt,{"menu-items":a,onMenuItemClickHandler:We=>st(We.label,_.row.streetId)},null,8,["onMenuItemClickHandler"])],4)),[[Ye,W.value===_.rowIndex]]):de("",!0)]),_:2},1024))),128))]),_:2},1032,["props","onMouseenter"])]),_:1},8,["rows","table-header-style"])):N.value===w.billingDefaulters?(A(),j(ze,{key:1,bordered:"",columns:C,rows:f.value,"visible-columns":I(y),"table-header-class":"text-bolder","table-header-style":{backgroundColor:`${S.$getColor("secondary")}`},title:"Billings Payment Defaulters"},{body:r(_=>[l(Le,{props:_,onMouseenter:Y=>he(_.rowIndex),onMouseleave:v[7]||(v[7]=Y=>he(-1))},{default:r(()=>[(A(!0),U(J,null,Ie(_.cols,Y=>(A(),j(Ze,{key:Y.name,class:"text-center",style:{postion:"relative"}},{default:r(()=>[l(ae,{label:Y.value,class:"text-bold",style:ue({backgroundColor:"transparent",color:`${S.$getColor("dark")}`})},null,8,["label","style"])]),_:2},1024))),128))]),_:2},1032,["props","onMouseenter"])]),_:1},8,["rows","visible-columns","table-header-style"])):N.value===w.billingDetails?(A(),j(ze,{key:2,bordered:"",columns:T,rows:f.value,"visible-columns":F,"table-header-class":"text-bolder","table-header-style":{backgroundColor:`${S.$getColor("secondary")}`},title:"Billing Details"},{body:r(_=>[l(Le,{props:_,onMouseenter:Y=>he(_.rowIndex),onMouseleave:v[8]||(v[8]=Y=>he(-1))},{default:r(()=>[(A(!0),U(J,null,Ie(_.cols,(Y,je)=>(A(),j(Ze,{key:Y.name,class:"text-center",style:{postion:"relative"}},{default:r(()=>[l(ae,{label:Y.value,class:"text-bold",style:ue({backgroundColor:"transparent",color:`${S.$getColor("dark")}`})},null,8,["label","style"]),je===_.cols.length-1?Oe((A(),U("span",{key:0,style:ue({position:"absolute",top:W.value===_.rowIndex?"0.5rem":"0",right:W.value===_.rowIndex?"0.5rem":"0",zIndex:W.value===_.rowIndex?"1":"0"})},[l(dt,{"menu-items":i,onMenuItemClickHandler:We=>ve(We.label,_.row.currentBillingId)},null,8,["onMenuItemClickHandler"])],4)),[[Ye,W.value===_.rowIndex]]):de("",!0)]),_:2},1024))),128))]),_:2},1032,["props","onMouseenter"])]),_:1},8,["rows","table-header-style"])):de("",!0)]),_:1})]),_:1})])]),_:1},8,["name"])]),_:1},8,["modelValue"])]),l(Ke,{modelValue:$.value,"onUpdate:modelValue":v[13]||(v[13]=_=>$.value=_)},{default:r(()=>[l(Je,{height:"auto",width:`${ut}rem`},{default:r(()=>[g.value===I(le).PROPERTIES?(A(),j(ma,{key:0,onAddSubscriber:v[10]||(v[10]=_=>St(I(_e).ADD_SUBSCRIBER)),onAddStreet:v[11]||(v[11]=_=>St(I(_e).ADD_STREET)),onAddPropertyType:v[12]||(v[12]=_=>St(I(_e).ADD_PROPERTY_TYPE))})):g.value===I(le).BILLINGS?(A(),j(Ca,{key:1})):de("",!0)]),_:1},8,["width"])]),_:1},8,["modelValue"]),l(Ke,{modelValue:K.value,"onUpdate:modelValue":v[14]||(v[14]=_=>K.value=_),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[l(Je,{height:"auto",width:`${ut-30}rem`},{default:r(()=>[V.value===I(_e).ADD_SUBSCRIBER?(A(),j(Oa,{key:0})):V.value===I(_e).ADD_STREET?(A(),j(qa,{key:1})):V.value===I(_e).ADD_PROPERTY_TYPE?(A(),j(ja,{key:2})):de("",!0)]),_:1},8,["width"])]),_:1},8,["modelValue"]),l(Ke,{modelValue:k.value,"onUpdate:modelValue":v[15]||(v[15]=_=>k.value=_),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[l(Je,{height:"auto",width:`${ut}rem`},{default:r(()=>[c.value===I(Be).ADD_LGA?(A(),j(Ka,{key:0})):c.value===I(Be).ADD_LGA_WARD?(A(),j(tn,{key:1})):de("",!0)]),_:1},8,["width"])]),_:1},8,["modelValue"]),l(Ke,{modelValue:ye.value,"onUpdate:modelValue":v[16]||(v[16]=_=>ye.value=_)},{default:r(()=>[l(so,{dialogWidth:ut,"property-subscription-id":I(Z)},null,8,["property-subscription-id"])]),_:1},8,["modelValue"])],4)]),_:1}))}});export{qo as default};
